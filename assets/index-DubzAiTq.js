var Nn=Object.defineProperty;var bn=(o,e,t)=>e in o?Nn(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var _=(o,e,t)=>bn(o,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ae{}function E(o,e){const t=/\{([^}]+)\}/g;return o.replace(t,(n,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const r=e[i];return r!=null?String(r):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function s(o,e,t){for(let r=0;r<e.length-1;r++){const u=e[r];if(u.endsWith("[]")){const a=u.slice(0,-2);if(!(a in o))if(Array.isArray(t))o[a]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(o[a])){const c=o[a];if(Array.isArray(t))for(let d=0;d<c.length;d++){const f=c[d];s(f,e.slice(r+1),t[d])}else for(const d of c)s(d,e.slice(r+1),t)}return}else if(u.endsWith("[0]")){const a=u.slice(0,-3);a in o||(o[a]=[{}]);const c=o[a];s(c[0],e.slice(r+1),t);return}(!o[u]||typeof o[u]!="object")&&(o[u]={}),o=o[u]}const n=e[e.length-1],i=o[n];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else o[n]=t}function l(o,e){try{if(e.length===1&&e[0]==="_self")return o;for(let t=0;t<e.length;t++){if(typeof o!="object"||o===null)return;const n=e[t];if(n.endsWith("[]")){const i=n.slice(0,-2);if(i in o){const r=o[i];return Array.isArray(r)?r.map(u=>l(u,e.slice(t+1))):void 0}else return}else o=o[n]}return o}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function b(o,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(o.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function jt(o,e){const t=b(o,e);return t?t.startsWith("publishers/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/${t}`:t.startsWith("models/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/publishers/google/${t}`:t:""}function it(o,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function le(o,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>it(o,t)):[it(o,e)]}function en(o){return o!=null&&typeof o=="object"&&"parts"in o&&Array.isArray(o.parts)}function Dn(o){return o!=null&&typeof o=="object"&&"functionCall"in o}function He(o){return!(o==null||Dn(o))}function tn(o){return o==null||Array.isArray(o)&&o.length===0?!1:o.every(He)}function D(o,e){if(e==null)throw new Error("ContentUnion is required");return en(e)?e:He(e)?{role:"user",parts:le(o,e)}:{role:"model",parts:le(o,e)}}function nn(o,e){if(!e)return[];if(o.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=D(o,t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(o.isVertexAI()){const t=D(o,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>D(o,t)):[D(o,e)]}function he(o,e,t){t.length!==0&&(tn(t)?e.push({role:"user",parts:le(o,t)}):e.push({role:"model",parts:le(o,t)}),t.length=0)}function Ln(o,e,t,n){He(n)===tn(t)||(he(o,e,t),t.length=0),t.push(n)}function A(o,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e))return[D(o,e)];const t=[],n=[];for(const i of e)if(en(i))he(o,t,n),t.push(i);else if(typeof i=="string"||typeof i=="object"&&!Array.isArray(i))Ln(o,t,n,i);else if(Array.isArray(i))he(o,t,n),t.push({role:"user",parts:le(o,i)});else throw new Error(`Unsupported content type: ${typeof i}`);return he(o,t,n),t}function me(o,e){if(!o.isVertexAI()&&"default"in e)throw new Error("Default value is not supported in the response schema for the Gemini API.");if("anyOf"in e&&e.anyOf!==void 0)for(const t of e.anyOf)me(o,t);if("items"in e&&e.items!==void 0&&me(o,e.items),"properties"in e&&e.properties!==void 0)for(const t of Object.values(e.properties))me(o,t)}function on(o,e){return me(o,e),e}function rn(o,e){if(typeof e=="object"&&"voiceConfig"in e)return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function sn(o,e){return e}function Q(o,e){if(!Array.isArray(e))throw new Error("tool is required and must be an array of Tools");return e}function Fn(o,e,t,n=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===n;return o.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${o.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}`:i?`projects/${o.getProject()}/locations/${o.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function $(o,e){if(typeof e!="string")throw new Error("name must be a string");return Fn(o,e,"cachedContents")}function B(o,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function ln(o,e){if(typeof e!="string")throw new Error("fromName must be a string");return e.startsWith("files/")?e.split("files/")[1]:e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qn(o,e){const t={};if(l(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=l(e,["thought"]);n!=null&&s(t,["thought"],n);const i=l(e,["codeExecutionResult"]);i!=null&&s(t,["codeExecutionResult"],i);const r=l(e,["executableCode"]);r!=null&&s(t,["executableCode"],r);const u=l(e,["fileData"]);u!=null&&s(t,["fileData"],u);const a=l(e,["functionCall"]);a!=null&&s(t,["functionCall"],a);const c=l(e,["functionResponse"]);c!=null&&s(t,["functionResponse"],c);const d=l(e,["inlineData"]);d!=null&&s(t,["inlineData"],d);const f=l(e,["text"]);return f!=null&&s(t,["text"],f),t}function rt(o,e){const t={},n=l(e,["parts"]);n!=null&&(Array.isArray(n)?s(t,["parts"],n.map(r=>qn(o,r))):s(t,["parts"],n));const i=l(e,["role"]);return i!=null&&s(t,["role"],i),t}function Vn(o,e){const t={};if(l(e,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");const n=l(e,["description"]);n!=null&&s(t,["description"],n);const i=l(e,["name"]);i!=null&&s(t,["name"],i);const r=l(e,["parameters"]);return r!=null&&s(t,["parameters"],r),t}function Un(){return{}}function Gn(o,e){const t={},n=l(e,["mode"]);n!=null&&s(t,["mode"],n);const i=l(e,["dynamicThreshold"]);return i!=null&&s(t,["dynamicThreshold"],i),t}function $n(o,e){const t={},n=l(e,["dynamicRetrievalConfig"]);return n!=null&&s(t,["dynamicRetrievalConfig"],Gn(o,n)),t}function Bn(o,e){const t={},n=l(e,["functionDeclarations"]);if(n!=null&&(Array.isArray(n)?s(t,["functionDeclarations"],n.map(a=>Vn(o,a))):s(t,["functionDeclarations"],n)),l(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");l(e,["googleSearch"])!=null&&s(t,["googleSearch"],Un());const r=l(e,["googleSearchRetrieval"]);r!=null&&s(t,["googleSearchRetrieval"],$n(o,r));const u=l(e,["codeExecution"]);return u!=null&&s(t,["codeExecution"],u),t}function Hn(o,e){const t={},n=l(e,["mode"]);n!=null&&s(t,["mode"],n);const i=l(e,["allowedFunctionNames"]);return i!=null&&s(t,["allowedFunctionNames"],i),t}function On(o,e){const t={},n=l(e,["functionCallingConfig"]);return n!=null&&s(t,["functionCallingConfig"],Hn(o,n)),t}function zn(o,e,t){const n={},i=l(e,["ttl"]);t!==void 0&&i!=null&&s(t,["ttl"],i);const r=l(e,["expireTime"]);t!==void 0&&r!=null&&s(t,["expireTime"],r);const u=l(e,["displayName"]);t!==void 0&&u!=null&&s(t,["displayName"],u);const a=l(e,["contents"]);t!==void 0&&a!=null&&(Array.isArray(a)?s(t,["contents"],A(o,A(o,a).map(p=>rt(o,p)))):s(t,["contents"],A(o,a)));const c=l(e,["systemInstruction"]);t!==void 0&&c!=null&&s(t,["systemInstruction"],rt(o,D(o,c)));const d=l(e,["tools"]);t!==void 0&&d!=null&&(Array.isArray(d)?s(t,["tools"],d.map(p=>Bn(o,p))):s(t,["tools"],d));const f=l(e,["toolConfig"]);return t!==void 0&&f!=null&&s(t,["toolConfig"],On(o,f)),n}function Yn(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["model"],jt(o,n));const i=l(e,["config"]);return i!=null&&s(t,["config"],zn(o,i,t)),t}function Kn(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["_url","name"],$(o,n));const i=l(e,["config"]);return i!=null&&s(t,["config"],i),t}function Wn(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["_url","name"],$(o,n));const i=l(e,["config"]);return i!=null&&s(t,["config"],i),t}function Jn(o,e,t){const n={},i=l(e,["ttl"]);t!==void 0&&i!=null&&s(t,["ttl"],i);const r=l(e,["expireTime"]);return t!==void 0&&r!=null&&s(t,["expireTime"],r),n}function Xn(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["_url","name"],$(o,n));const i=l(e,["config"]);return i!=null&&s(t,["config"],Jn(o,i,t)),t}function Zn(o,e,t){const n={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&s(t,["_query","pageSize"],i);const r=l(e,["pageToken"]);return t!==void 0&&r!=null&&s(t,["_query","pageToken"],r),n}function Qn(o,e){const t={},n=l(e,["config"]);return n!=null&&s(t,["config"],Zn(o,n,t)),t}function jn(o,e){const t={},n=l(e,["videoMetadata"]);n!=null&&s(t,["videoMetadata"],n);const i=l(e,["thought"]);i!=null&&s(t,["thought"],i);const r=l(e,["codeExecutionResult"]);r!=null&&s(t,["codeExecutionResult"],r);const u=l(e,["executableCode"]);u!=null&&s(t,["executableCode"],u);const a=l(e,["fileData"]);a!=null&&s(t,["fileData"],a);const c=l(e,["functionCall"]);c!=null&&s(t,["functionCall"],c);const d=l(e,["functionResponse"]);d!=null&&s(t,["functionResponse"],d);const f=l(e,["inlineData"]);f!=null&&s(t,["inlineData"],f);const p=l(e,["text"]);return p!=null&&s(t,["text"],p),t}function st(o,e){const t={},n=l(e,["parts"]);n!=null&&(Array.isArray(n)?s(t,["parts"],n.map(r=>jn(o,r))):s(t,["parts"],n));const i=l(e,["role"]);return i!=null&&s(t,["role"],i),t}function eo(o,e){const t={},n=l(e,["example"]);n!=null&&s(t,["example"],n);const i=l(e,["pattern"]);i!=null&&s(t,["pattern"],i);const r=l(e,["default"]);r!=null&&s(t,["default"],r);const u=l(e,["maxLength"]);u!=null&&s(t,["maxLength"],u);const a=l(e,["minLength"]);a!=null&&s(t,["minLength"],a);const c=l(e,["minProperties"]);c!=null&&s(t,["minProperties"],c);const d=l(e,["maxProperties"]);d!=null&&s(t,["maxProperties"],d);const f=l(e,["anyOf"]);f!=null&&s(t,["anyOf"],f);const p=l(e,["description"]);p!=null&&s(t,["description"],p);const h=l(e,["enum"]);h!=null&&s(t,["enum"],h);const g=l(e,["format"]);g!=null&&s(t,["format"],g);const m=l(e,["items"]);m!=null&&s(t,["items"],m);const y=l(e,["maxItems"]);y!=null&&s(t,["maxItems"],y);const C=l(e,["maximum"]);C!=null&&s(t,["maximum"],C);const v=l(e,["minItems"]);v!=null&&s(t,["minItems"],v);const T=l(e,["minimum"]);T!=null&&s(t,["minimum"],T);const x=l(e,["nullable"]);x!=null&&s(t,["nullable"],x);const I=l(e,["properties"]);I!=null&&s(t,["properties"],I);const M=l(e,["propertyOrdering"]);M!=null&&s(t,["propertyOrdering"],M);const R=l(e,["required"]);R!=null&&s(t,["required"],R);const k=l(e,["title"]);k!=null&&s(t,["title"],k);const F=l(e,["type"]);return F!=null&&s(t,["type"],F),t}function to(o,e){const t={},n=l(e,["response"]);n!=null&&s(t,["response"],eo(o,n));const i=l(e,["description"]);i!=null&&s(t,["description"],i);const r=l(e,["name"]);r!=null&&s(t,["name"],r);const u=l(e,["parameters"]);return u!=null&&s(t,["parameters"],u),t}function no(){return{}}function oo(o,e){const t={},n=l(e,["mode"]);n!=null&&s(t,["mode"],n);const i=l(e,["dynamicThreshold"]);return i!=null&&s(t,["dynamicThreshold"],i),t}function io(o,e){const t={},n=l(e,["dynamicRetrievalConfig"]);return n!=null&&s(t,["dynamicRetrievalConfig"],oo(o,n)),t}function ro(o,e){const t={},n=l(e,["functionDeclarations"]);n!=null&&(Array.isArray(n)?s(t,["functionDeclarations"],n.map(c=>to(o,c))):s(t,["functionDeclarations"],n));const i=l(e,["retrieval"]);i!=null&&s(t,["retrieval"],i),l(e,["googleSearch"])!=null&&s(t,["googleSearch"],no());const u=l(e,["googleSearchRetrieval"]);u!=null&&s(t,["googleSearchRetrieval"],io(o,u));const a=l(e,["codeExecution"]);return a!=null&&s(t,["codeExecution"],a),t}function so(o,e){const t={},n=l(e,["mode"]);n!=null&&s(t,["mode"],n);const i=l(e,["allowedFunctionNames"]);return i!=null&&s(t,["allowedFunctionNames"],i),t}function lo(o,e){const t={},n=l(e,["functionCallingConfig"]);return n!=null&&s(t,["functionCallingConfig"],so(o,n)),t}function ao(o,e,t){const n={},i=l(e,["ttl"]);t!==void 0&&i!=null&&s(t,["ttl"],i);const r=l(e,["expireTime"]);t!==void 0&&r!=null&&s(t,["expireTime"],r);const u=l(e,["displayName"]);t!==void 0&&u!=null&&s(t,["displayName"],u);const a=l(e,["contents"]);t!==void 0&&a!=null&&(Array.isArray(a)?s(t,["contents"],A(o,A(o,a).map(p=>st(o,p)))):s(t,["contents"],A(o,a)));const c=l(e,["systemInstruction"]);t!==void 0&&c!=null&&s(t,["systemInstruction"],st(o,D(o,c)));const d=l(e,["tools"]);t!==void 0&&d!=null&&(Array.isArray(d)?s(t,["tools"],d.map(p=>ro(o,p))):s(t,["tools"],d));const f=l(e,["toolConfig"]);return t!==void 0&&f!=null&&s(t,["toolConfig"],lo(o,f)),n}function uo(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["model"],jt(o,n));const i=l(e,["config"]);return i!=null&&s(t,["config"],ao(o,i,t)),t}function co(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["_url","name"],$(o,n));const i=l(e,["config"]);return i!=null&&s(t,["config"],i),t}function fo(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["_url","name"],$(o,n));const i=l(e,["config"]);return i!=null&&s(t,["config"],i),t}function po(o,e,t){const n={},i=l(e,["ttl"]);t!==void 0&&i!=null&&s(t,["ttl"],i);const r=l(e,["expireTime"]);return t!==void 0&&r!=null&&s(t,["expireTime"],r),n}function ho(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["_url","name"],$(o,n));const i=l(e,["config"]);return i!=null&&s(t,["config"],po(o,i,t)),t}function mo(o,e,t){const n={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&s(t,["_query","pageSize"],i);const r=l(e,["pageToken"]);return t!==void 0&&r!=null&&s(t,["_query","pageToken"],r),n}function go(o,e){const t={},n=l(e,["config"]);return n!=null&&s(t,["config"],mo(o,n,t)),t}function ge(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["name"],n);const i=l(e,["displayName"]);i!=null&&s(t,["displayName"],i);const r=l(e,["model"]);r!=null&&s(t,["model"],r);const u=l(e,["createTime"]);u!=null&&s(t,["createTime"],u);const a=l(e,["updateTime"]);a!=null&&s(t,["updateTime"],a);const c=l(e,["expireTime"]);c!=null&&s(t,["expireTime"],c);const d=l(e,["usageMetadata"]);return d!=null&&s(t,["usageMetadata"],d),t}function yo(){return{}}function Co(o,e){const t={},n=l(e,["nextPageToken"]);n!=null&&s(t,["nextPageToken"],n);const i=l(e,["cachedContents"]);return i!=null&&(Array.isArray(i)?s(t,["cachedContents"],i.map(r=>ge(o,r))):s(t,["cachedContents"],i)),t}function ye(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["name"],n);const i=l(e,["displayName"]);i!=null&&s(t,["displayName"],i);const r=l(e,["model"]);r!=null&&s(t,["model"],r);const u=l(e,["createTime"]);u!=null&&s(t,["createTime"],u);const a=l(e,["updateTime"]);a!=null&&s(t,["updateTime"],a);const c=l(e,["expireTime"]);c!=null&&s(t,["expireTime"],c);const d=l(e,["usageMetadata"]);return d!=null&&s(t,["usageMetadata"],d),t}function To(){return{}}function vo(o,e){const t={},n=l(e,["nextPageToken"]);n!=null&&s(t,["nextPageToken"],n);const i=l(e,["cachedContents"]);return i!=null&&(Array.isArray(i)?s(t,["cachedContents"],i.map(r=>ye(o,r))):s(t,["cachedContents"],i)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Te;(function(o){o.PAGED_ITEM_BATCH_JOBS="batchJobs",o.PAGED_ITEM_MODELS="models",o.PAGED_ITEM_TUNING_JOBS="tuningJobs",o.PAGED_ITEM_FILES="files",o.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Te||(Te={}));class an{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i)}init(e,t,n){var i,r;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let u={config:{}};n?typeof n=="object"?u=Object.assign({},n):u=n:u={config:{}},u.config&&(u.config.pageToken=t.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(r=(i=u.config)===null||i===void 0?void 0:i.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var lt;(function(o){o.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",o.OUTCOME_OK="OUTCOME_OK",o.OUTCOME_FAILED="OUTCOME_FAILED",o.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(lt||(lt={}));var at;(function(o){o.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",o.PYTHON="PYTHON"})(at||(at={}));var ut;(function(o){o.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT"})(ut||(ut={}));var ct;(function(o){o.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",o.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",o.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",o.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",o.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(ct||(ct={}));var dt;(function(o){o.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",o.SEVERITY="SEVERITY",o.PROBABILITY="PROBABILITY"})(dt||(dt={}));var ft;(function(o){o.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE",o.OFF="OFF"})(ft||(ft={}));var pt;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(pt||(pt={}));var ht;(function(o){o.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",o.STOP="STOP",o.MAX_TOKENS="MAX_TOKENS",o.SAFETY="SAFETY",o.RECITATION="RECITATION",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",o.SPII="SPII",o.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",o.IMAGE_SAFETY="IMAGE_SAFETY"})(ht||(ht={}));var mt;(function(o){o.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",o.NEGLIGIBLE="NEGLIGIBLE",o.LOW="LOW",o.MEDIUM="MEDIUM",o.HIGH="HIGH"})(mt||(mt={}));var gt;(function(o){o.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",o.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",o.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",o.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",o.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(gt||(gt={}));var yt;(function(o){o.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(yt||(yt={}));var ve;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.AUDIO="AUDIO"})(ve||(ve={}));var Ct;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.ACTIVE="ACTIVE",o.ERROR="ERROR"})(Ct||(Ct={}));var Tt;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(Tt||(Tt={}));var vt;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.AUTO="AUTO",o.ANY="ANY",o.NONE="NONE"})(vt||(vt={}));var xt;(function(o){o.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",o.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",o.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",o.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(xt||(xt={}));var Et;(function(o){o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE"})(Et||(Et={}));var wt;(function(o){o.DONT_ALLOW="DONT_ALLOW",o.ALLOW_ADULT="ALLOW_ADULT",o.ALLOW_ALL="ALLOW_ALL"})(wt||(wt={}));var St;(function(o){o.auto="auto",o.en="en",o.ja="ja",o.ko="ko",o.hi="hi"})(St||(St={}));var _t;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.PROCESSING="PROCESSING",o.ACTIVE="ACTIVE",o.FAILED="FAILED"})(_t||(_t={}));var At;(function(o){o.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",o.UPLOADED="UPLOADED",o.GENERATED="GENERATED"})(At||(At={}));var It;(function(o){o.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",o.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",o.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",o.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",o.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(It||(It={}));var Rt;(function(o){o.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",o.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",o.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",o.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Rt||(Rt={}));var kt;(function(o){o.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",o.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",o.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",o.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(kt||(kt={}));var Mt;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.VIDEO="VIDEO",o.AUDIO="AUDIO",o.DOCUMENT="DOCUMENT"})(Mt||(Mt={}));class de{get text(){var e,t,n,i,r,u,a,c;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",f=!1;const p=[];for(const h of(c=(a=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[g,m]of Object.entries(h))g!=="text"&&g!=="thought"&&(m!==null||m!==void 0)&&p.push(g);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;f=!0,d+=h.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?d:void 0}get functionCalls(){var e,t,n,i,r,u,a,c;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(a=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,t,n,i,r,u,a,c,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(c=(a=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,n,i,r,u,a,c,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(c=(a=(u=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.output}}class Pt{}class Nt{}class bt{}class xo{}class Dt{}class Lt{}class Eo{}class un{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class wo{}class So{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _o extends Ae{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new an(Te.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=uo(this.apiClient,e);return r=E("cachedContents",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>ye(this.apiClient,c))}else{const a=Yn(this.apiClient,e);return r=E("cachedContents",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>ge(this.apiClient,c))}}async get(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=co(this.apiClient,e);return r=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>ye(this.apiClient,c))}else{const a=Kn(this.apiClient,e);return r=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>ge(this.apiClient,c))}}async delete(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=fo(this.apiClient,e);return r=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(()=>{const c=To(),d=new Dt;return Object.assign(d,c),d})}else{const a=Wn(this.apiClient,e);return r=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(()=>{const c=yo(),d=new Dt;return Object.assign(d,c),d})}}async update(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=ho(this.apiClient,e);return r=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>ye(this.apiClient,c))}else{const a=Xn(this.apiClient,e);return r=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>ge(this.apiClient,c))}}async listInternal(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=go(this.apiClient,e);return r=E("cachedContents",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>{const d=vo(this.apiClient,c),f=new Lt;return Object.assign(f,d),f})}else{const a=Qn(this.apiClient,e);return r=E("cachedContents",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>{const d=Co(this.apiClient,c),f=new Lt;return Object.assign(f,d),f})}}}function Ft(o){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&o[e],n=0;if(t)return t.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&n>=o.length&&(o=void 0),{value:o&&o[n++],done:!o}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function N(o){return this instanceof N?(this.v=o,this):new N(o)}function xe(o,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(o,e||[]),i,r=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",u),i[Symbol.asyncIterator]=function(){return this},i;function u(g){return function(m){return Promise.resolve(m).then(g,p)}}function a(g,m){n[g]&&(i[g]=function(y){return new Promise(function(C,v){r.push([g,y,C,v])>1||c(g,y)})},m&&(i[g]=m(i[g])))}function c(g,m){try{d(n[g](m))}catch(y){h(r[0][3],y)}}function d(g){g.value instanceof N?Promise.resolve(g.value.v).then(f,p):h(r[0][2],g)}function f(g){c("next",g)}function p(g){c("throw",g)}function h(g,m){g(m),r.shift(),r.length&&c(r[0][0],r[0][1])}}function Pe(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=o[Symbol.asyncIterator],t;return e?e.call(o):(o=typeof Ft=="function"?Ft(o):o[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=o[r]&&function(u){return new Promise(function(a,c){u=o[r](u),i(a,c,u.done,u.value)})}}function i(r,u,a,c){Promise.resolve(c).then(function(d){r({value:d,done:a})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ao(o){var e;if(o.candidates==null||o.candidates.length===0)return!1;const t=(e=o.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:cn(t)}function cn(o){if(o.parts===void 0||o.parts.length===0)return!1;for(const e of o.parts)if(e===void 0||Object.keys(e).length===0||e.text!==void 0&&e.text==="")return!1;return!0}function Io(o){if(o.length!==0){if(o[0].role!=="user")throw new Error("History must start with a user turn.");for(const e of o)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Ro(o){if(o===void 0||o.length===0)return[];const e=[],t=o.length;let n=0,i=o[0];for(;n<t;)if(o[n].role==="user")i=o[n],n++;else{const r=[];let u=!0;for(;n<t&&o[n].role==="model";)r.push(o[n]),u&&!cn(o[n])&&(u=!1),n++;u&&(e.push(i),e.push(...r))}return e}class ko{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new Mo(this.apiClient,this.modelsModule,e.model,e.config,e.history)}}class Mo{constructor(e,t,n,i={},r=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=r,this.sendPromise=Promise.resolve(),Io(r)}async sendMessage(e){var t;await this.sendPromise;const n=D(this.apiClient,e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var r,u;const c=(u=(r=(await i).candidates)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.content,d=c?[c]:[];this.recordHistory(n,d)})(),await this.sendPromise,i}async sendMessageStream(e){var t;await this.sendPromise;const n=D(this.apiClient,e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{});const r=await i;return this.processStreamResponse(r,n)}getHistory(e=!1){return e?Ro(this.history):this.history}processStreamResponse(e,t){var n,i;return xe(this,arguments,function*(){var u,a,c,d;const f=[];try{for(var p=!0,h=Pe(e),g;g=yield N(h.next()),u=g.done,!u;p=!0){d=g.value,p=!1;const m=d;if(Ao(m)){const y=(i=(n=m.candidates)===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.content;y!==void 0&&f.push(y)}yield yield N(m)}}catch(m){a={error:m}}finally{try{!p&&!u&&(c=h.return)&&(yield N(c.call(h)))}finally{if(a)throw a.error}}this.recordHistory(t,f)})}recordHistory(e,t){let n=[];t.length>0&&t.every(i=>i.role==="model")?n=t:n.push({role:"model",parts:[]}),this.history.push(e),this.history.push(...n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Po(o,e,t){const n={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&s(t,["_query","pageSize"],i);const r=l(e,["pageToken"]);return t!==void 0&&r!=null&&s(t,["_query","pageToken"],r),n}function No(o,e){const t={},n=l(e,["config"]);return n!=null&&s(t,["config"],Po(o,n,t)),t}function bo(o,e){const t={},n=l(e,["details"]);n!=null&&s(t,["details"],n);const i=l(e,["message"]);i!=null&&s(t,["message"],i);const r=l(e,["code"]);return r!=null&&s(t,["code"],r),t}function Do(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["name"],n);const i=l(e,["displayName"]);i!=null&&s(t,["displayName"],i);const r=l(e,["mimeType"]);r!=null&&s(t,["mimeType"],r);const u=l(e,["sizeBytes"]);u!=null&&s(t,["sizeBytes"],u);const a=l(e,["createTime"]);a!=null&&s(t,["createTime"],a);const c=l(e,["expirationTime"]);c!=null&&s(t,["expirationTime"],c);const d=l(e,["updateTime"]);d!=null&&s(t,["updateTime"],d);const f=l(e,["sha256Hash"]);f!=null&&s(t,["sha256Hash"],f);const p=l(e,["uri"]);p!=null&&s(t,["uri"],p);const h=l(e,["downloadUri"]);h!=null&&s(t,["downloadUri"],h);const g=l(e,["state"]);g!=null&&s(t,["state"],g);const m=l(e,["source"]);m!=null&&s(t,["source"],m);const y=l(e,["videoMetadata"]);y!=null&&s(t,["videoMetadata"],y);const C=l(e,["error"]);return C!=null&&s(t,["error"],bo(o,C)),t}function Lo(o,e){const t={},n=l(e,["file"]);n!=null&&s(t,["file"],Do(o,n));const i=l(e,["config"]);return i!=null&&s(t,["config"],i),t}function Fo(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["_url","file"],ln(o,n));const i=l(e,["config"]);return i!=null&&s(t,["config"],i),t}function qo(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["_url","file"],ln(o,n));const i=l(e,["config"]);return i!=null&&s(t,["config"],i),t}function Vo(o,e){const t={},n=l(e,["details"]);n!=null&&s(t,["details"],n);const i=l(e,["message"]);i!=null&&s(t,["message"],i);const r=l(e,["code"]);return r!=null&&s(t,["code"],r),t}function Ne(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["name"],n);const i=l(e,["displayName"]);i!=null&&s(t,["displayName"],i);const r=l(e,["mimeType"]);r!=null&&s(t,["mimeType"],r);const u=l(e,["sizeBytes"]);u!=null&&s(t,["sizeBytes"],u);const a=l(e,["createTime"]);a!=null&&s(t,["createTime"],a);const c=l(e,["expirationTime"]);c!=null&&s(t,["expirationTime"],c);const d=l(e,["updateTime"]);d!=null&&s(t,["updateTime"],d);const f=l(e,["sha256Hash"]);f!=null&&s(t,["sha256Hash"],f);const p=l(e,["uri"]);p!=null&&s(t,["uri"],p);const h=l(e,["downloadUri"]);h!=null&&s(t,["downloadUri"],h);const g=l(e,["state"]);g!=null&&s(t,["state"],g);const m=l(e,["source"]);m!=null&&s(t,["source"],m);const y=l(e,["videoMetadata"]);y!=null&&s(t,["videoMetadata"],y);const C=l(e,["error"]);return C!=null&&s(t,["error"],Vo(o,C)),t}function Uo(o,e){const t={},n=l(e,["nextPageToken"]);n!=null&&s(t,["nextPageToken"],n);const i=l(e,["files"]);return i!=null&&(Array.isArray(i)?s(t,["files"],i.map(r=>Ne(o,r))):s(t,["files"],i)),t}function Go(o,e){const t={},n=l(e,["httpHeaders"]);return n!=null&&s(t,["httpHeaders"],n),t}function $o(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Bo extends Ae{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new an(Te.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>Ne(this.apiClient,t))}async listInternal(e){var t;let n,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=No(this.apiClient,e);return i=E("files",u._url),r=u._query,delete u.config,delete u._url,delete u._query,n=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(a=>a.json()),n.then(a=>{const c=Uo(this.apiClient,a),d=new Eo;return Object.assign(d,c),d})}}async createInternal(e){var t;let n,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Lo(this.apiClient,e);return i=E("upload/v1beta/files",u._url),r=u._query,delete u.config,delete u._url,delete u._query,n=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(a=>a.json()),n.then(a=>{const c=Go(this.apiClient,a),d=new wo;return Object.assign(d,c),d})}}async get(e){var t;let n,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Fo(this.apiClient,e);return i=E("files/{file}",u._url),r=u._query,delete u.config,delete u._url,delete u._query,n=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(a=>a.json()),n.then(a=>Ne(this.apiClient,a))}}async delete(e){var t;let n,i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=qo(this.apiClient,e);return i=E("files/{file}",u._url),r=u._query,delete u.config,delete u._url,delete u._query,n=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(a=>a.json()),n.then(()=>{const a=$o(),c=new So;return Object.assign(c,a),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ho(o,e){const t={};if(l(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=l(e,["thought"]);n!=null&&s(t,["thought"],n);const i=l(e,["codeExecutionResult"]);i!=null&&s(t,["codeExecutionResult"],i);const r=l(e,["executableCode"]);r!=null&&s(t,["executableCode"],r);const u=l(e,["fileData"]);u!=null&&s(t,["fileData"],u);const a=l(e,["functionCall"]);a!=null&&s(t,["functionCall"],a);const c=l(e,["functionResponse"]);c!=null&&s(t,["functionResponse"],c);const d=l(e,["inlineData"]);d!=null&&s(t,["inlineData"],d);const f=l(e,["text"]);return f!=null&&s(t,["text"],f),t}function ue(o,e){const t={},n=l(e,["parts"]);n!=null&&(Array.isArray(n)?s(t,["parts"],n.map(r=>Ho(o,r))):s(t,["parts"],n));const i=l(e,["role"]);return i!=null&&s(t,["role"],i),t}function Oo(o,e){const t={};if(l(e,["example"])!==void 0)throw new Error("example parameter is not supported in Gemini API.");if(l(e,["pattern"])!==void 0)throw new Error("pattern parameter is not supported in Gemini API.");if(l(e,["default"])!==void 0)throw new Error("default parameter is not supported in Gemini API.");if(l(e,["maxLength"])!==void 0)throw new Error("maxLength parameter is not supported in Gemini API.");if(l(e,["minLength"])!==void 0)throw new Error("minLength parameter is not supported in Gemini API.");if(l(e,["minProperties"])!==void 0)throw new Error("minProperties parameter is not supported in Gemini API.");if(l(e,["maxProperties"])!==void 0)throw new Error("maxProperties parameter is not supported in Gemini API.");const n=l(e,["anyOf"]);n!=null&&s(t,["anyOf"],n);const i=l(e,["description"]);i!=null&&s(t,["description"],i);const r=l(e,["enum"]);r!=null&&s(t,["enum"],r);const u=l(e,["format"]);u!=null&&s(t,["format"],u);const a=l(e,["items"]);a!=null&&s(t,["items"],a);const c=l(e,["maxItems"]);c!=null&&s(t,["maxItems"],c);const d=l(e,["maximum"]);d!=null&&s(t,["maximum"],d);const f=l(e,["minItems"]);f!=null&&s(t,["minItems"],f);const p=l(e,["minimum"]);p!=null&&s(t,["minimum"],p);const h=l(e,["nullable"]);h!=null&&s(t,["nullable"],h);const g=l(e,["properties"]);g!=null&&s(t,["properties"],g);const m=l(e,["propertyOrdering"]);m!=null&&s(t,["propertyOrdering"],m);const y=l(e,["required"]);y!=null&&s(t,["required"],y);const C=l(e,["title"]);C!=null&&s(t,["title"],C);const v=l(e,["type"]);return v!=null&&s(t,["type"],v),t}function zo(o,e){const t={};if(l(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=l(e,["category"]);n!=null&&s(t,["category"],n);const i=l(e,["threshold"]);return i!=null&&s(t,["threshold"],i),t}function Yo(o,e){const t={};if(l(e,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");const n=l(e,["description"]);n!=null&&s(t,["description"],n);const i=l(e,["name"]);i!=null&&s(t,["name"],i);const r=l(e,["parameters"]);return r!=null&&s(t,["parameters"],r),t}function Ko(){return{}}function Wo(o,e){const t={},n=l(e,["mode"]);n!=null&&s(t,["mode"],n);const i=l(e,["dynamicThreshold"]);return i!=null&&s(t,["dynamicThreshold"],i),t}function Jo(o,e){const t={},n=l(e,["dynamicRetrievalConfig"]);return n!=null&&s(t,["dynamicRetrievalConfig"],Wo(o,n)),t}function dn(o,e){const t={},n=l(e,["functionDeclarations"]);if(n!=null&&(Array.isArray(n)?s(t,["functionDeclarations"],n.map(a=>Yo(o,a))):s(t,["functionDeclarations"],n)),l(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");l(e,["googleSearch"])!=null&&s(t,["googleSearch"],Ko());const r=l(e,["googleSearchRetrieval"]);r!=null&&s(t,["googleSearchRetrieval"],Jo(o,r));const u=l(e,["codeExecution"]);return u!=null&&s(t,["codeExecution"],u),t}function Xo(o,e){const t={},n=l(e,["mode"]);n!=null&&s(t,["mode"],n);const i=l(e,["allowedFunctionNames"]);return i!=null&&s(t,["allowedFunctionNames"],i),t}function Zo(o,e){const t={},n=l(e,["functionCallingConfig"]);return n!=null&&s(t,["functionCallingConfig"],Xo(o,n)),t}function Qo(o,e){const t={},n=l(e,["voiceName"]);return n!=null&&s(t,["voiceName"],n),t}function jo(o,e){const t={},n=l(e,["prebuiltVoiceConfig"]);return n!=null&&s(t,["prebuiltVoiceConfig"],Qo(o,n)),t}function ei(o,e){const t={},n=l(e,["voiceConfig"]);return n!=null&&s(t,["voiceConfig"],jo(o,n)),t}function ti(o,e){const t={},n=l(e,["includeThoughts"]);return n!=null&&s(t,["includeThoughts"],n),t}function ni(o,e,t){const n={},i=l(e,["systemInstruction"]);t!==void 0&&i!=null&&s(t,["systemInstruction"],ue(o,D(o,i)));const r=l(e,["temperature"]);r!=null&&s(n,["temperature"],r);const u=l(e,["topP"]);u!=null&&s(n,["topP"],u);const a=l(e,["topK"]);a!=null&&s(n,["topK"],a);const c=l(e,["candidateCount"]);c!=null&&s(n,["candidateCount"],c);const d=l(e,["maxOutputTokens"]);d!=null&&s(n,["maxOutputTokens"],d);const f=l(e,["stopSequences"]);f!=null&&s(n,["stopSequences"],f);const p=l(e,["responseLogprobs"]);p!=null&&s(n,["responseLogprobs"],p);const h=l(e,["logprobs"]);h!=null&&s(n,["logprobs"],h);const g=l(e,["presencePenalty"]);g!=null&&s(n,["presencePenalty"],g);const m=l(e,["frequencyPenalty"]);m!=null&&s(n,["frequencyPenalty"],m);const y=l(e,["seed"]);y!=null&&s(n,["seed"],y);const C=l(e,["responseMimeType"]);C!=null&&s(n,["responseMimeType"],C);const v=l(e,["responseSchema"]);if(v!=null&&s(n,["responseSchema"],Oo(o,on(o,v))),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");const T=l(e,["safetySettings"]);t!==void 0&&T!=null&&(Array.isArray(T)?s(t,["safetySettings"],T.map(J=>zo(o,J))):s(t,["safetySettings"],T));const x=l(e,["tools"]);t!==void 0&&x!=null&&(Array.isArray(x)?s(t,["tools"],Q(o,Q(o,x).map(J=>dn(o,sn(o,J))))):s(t,["tools"],Q(o,x)));const I=l(e,["toolConfig"]);if(t!==void 0&&I!=null&&s(t,["toolConfig"],Zo(o,I)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=l(e,["cachedContent"]);t!==void 0&&M!=null&&s(t,["cachedContent"],$(o,M));const R=l(e,["responseModalities"]);R!=null&&s(n,["responseModalities"],R);const k=l(e,["mediaResolution"]);k!=null&&s(n,["mediaResolution"],k);const F=l(e,["speechConfig"]);if(F!=null&&s(n,["speechConfig"],ei(o,rn(o,F))),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const te=l(e,["thinkingConfig"]);return te!=null&&s(n,["thinkingConfig"],ti(o,te)),n}function qt(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["_url","model"],b(o,n));const i=l(e,["contents"]);i!=null&&(Array.isArray(i)?s(t,["contents"],A(o,A(o,i).map(u=>ue(o,u)))):s(t,["contents"],A(o,i)));const r=l(e,["config"]);return r!=null&&s(t,["generationConfig"],ni(o,r,t)),t}function oi(o,e,t){const n={},i=l(e,["taskType"]);t!==void 0&&i!=null&&s(t,["requests[]","taskType"],i);const r=l(e,["title"]);t!==void 0&&r!=null&&s(t,["requests[]","title"],r);const u=l(e,["outputDimensionality"]);if(t!==void 0&&u!=null&&s(t,["requests[]","outputDimensionality"],u),l(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function ii(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["_url","model"],b(o,n));const i=l(e,["contents"]);i!=null&&s(t,["requests[]","content"],nn(o,i));const r=l(e,["config"]);r!=null&&s(t,["config"],oi(o,r,t));const u=l(e,["model"]);return u!==void 0&&s(t,["requests[]","model"],b(o,u)),t}function ri(o,e,t){const n={};if(l(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=l(e,["numberOfImages"]);t!==void 0&&i!=null&&s(t,["parameters","sampleCount"],i);const r=l(e,["aspectRatio"]);t!==void 0&&r!=null&&s(t,["parameters","aspectRatio"],r);const u=l(e,["guidanceScale"]);if(t!==void 0&&u!=null&&s(t,["parameters","guidanceScale"],u),l(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=l(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&s(t,["parameters","safetySetting"],a);const c=l(e,["personGeneration"]);t!==void 0&&c!=null&&s(t,["parameters","personGeneration"],c);const d=l(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&s(t,["parameters","includeSafetyAttributes"],d);const f=l(e,["includeRaiReason"]);t!==void 0&&f!=null&&s(t,["parameters","includeRaiReason"],f);const p=l(e,["language"]);t!==void 0&&p!=null&&s(t,["parameters","language"],p);const h=l(e,["outputMimeType"]);t!==void 0&&h!=null&&s(t,["parameters","outputOptions","mimeType"],h);const g=l(e,["outputCompressionQuality"]);if(t!==void 0&&g!=null&&s(t,["parameters","outputOptions","compressionQuality"],g),l(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(l(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function si(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["_url","model"],b(o,n));const i=l(e,["prompt"]);i!=null&&s(t,["instances[0]","prompt"],i);const r=l(e,["config"]);return r!=null&&s(t,["config"],ri(o,r,t)),t}function li(o,e){const t={};if(l(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(l(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(l(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function ai(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["_url","model"],b(o,n));const i=l(e,["contents"]);i!=null&&(Array.isArray(i)?s(t,["contents"],A(o,A(o,i).map(u=>ue(o,u)))):s(t,["contents"],A(o,i)));const r=l(e,["config"]);return r!=null&&s(t,["config"],li(o,r)),t}function ui(o,e){const t={};if(l(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=l(e,["imageBytes"]);n!=null&&s(t,["bytesBase64Encoded"],B(o,n));const i=l(e,["mimeType"]);return i!=null&&s(t,["mimeType"],i),t}function ci(o,e,t){const n={},i=l(e,["numberOfVideos"]);if(t!==void 0&&i!=null&&s(t,["parameters","sampleCount"],i),l(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=l(e,["durationSeconds"]);if(t!==void 0&&r!=null&&s(t,["parameters","durationSeconds"],r),l(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=l(e,["aspectRatio"]);if(t!==void 0&&u!=null&&s(t,["parameters","aspectRatio"],u),l(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const a=l(e,["personGeneration"]);if(t!==void 0&&a!=null&&s(t,["parameters","personGeneration"],a),l(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=l(e,["negativePrompt"]);if(t!==void 0&&c!=null&&s(t,["parameters","negativePrompt"],c),l(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function di(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["_url","model"],b(o,n));const i=l(e,["prompt"]);i!=null&&s(t,["instances[0]","prompt"],i);const r=l(e,["image"]);r!=null&&s(t,["instances[0]","image"],ui(o,r));const u=l(e,["config"]);return u!=null&&s(t,["config"],ci(o,u,t)),t}function fi(o,e){const t={},n=l(e,["videoMetadata"]);n!=null&&s(t,["videoMetadata"],n);const i=l(e,["thought"]);i!=null&&s(t,["thought"],i);const r=l(e,["codeExecutionResult"]);r!=null&&s(t,["codeExecutionResult"],r);const u=l(e,["executableCode"]);u!=null&&s(t,["executableCode"],u);const a=l(e,["fileData"]);a!=null&&s(t,["fileData"],a);const c=l(e,["functionCall"]);c!=null&&s(t,["functionCall"],c);const d=l(e,["functionResponse"]);d!=null&&s(t,["functionResponse"],d);const f=l(e,["inlineData"]);f!=null&&s(t,["inlineData"],f);const p=l(e,["text"]);return p!=null&&s(t,["text"],p),t}function K(o,e){const t={},n=l(e,["parts"]);n!=null&&(Array.isArray(n)?s(t,["parts"],n.map(r=>fi(o,r))):s(t,["parts"],n));const i=l(e,["role"]);return i!=null&&s(t,["role"],i),t}function fn(o,e){const t={},n=l(e,["example"]);n!=null&&s(t,["example"],n);const i=l(e,["pattern"]);i!=null&&s(t,["pattern"],i);const r=l(e,["default"]);r!=null&&s(t,["default"],r);const u=l(e,["maxLength"]);u!=null&&s(t,["maxLength"],u);const a=l(e,["minLength"]);a!=null&&s(t,["minLength"],a);const c=l(e,["minProperties"]);c!=null&&s(t,["minProperties"],c);const d=l(e,["maxProperties"]);d!=null&&s(t,["maxProperties"],d);const f=l(e,["anyOf"]);f!=null&&s(t,["anyOf"],f);const p=l(e,["description"]);p!=null&&s(t,["description"],p);const h=l(e,["enum"]);h!=null&&s(t,["enum"],h);const g=l(e,["format"]);g!=null&&s(t,["format"],g);const m=l(e,["items"]);m!=null&&s(t,["items"],m);const y=l(e,["maxItems"]);y!=null&&s(t,["maxItems"],y);const C=l(e,["maximum"]);C!=null&&s(t,["maximum"],C);const v=l(e,["minItems"]);v!=null&&s(t,["minItems"],v);const T=l(e,["minimum"]);T!=null&&s(t,["minimum"],T);const x=l(e,["nullable"]);x!=null&&s(t,["nullable"],x);const I=l(e,["properties"]);I!=null&&s(t,["properties"],I);const M=l(e,["propertyOrdering"]);M!=null&&s(t,["propertyOrdering"],M);const R=l(e,["required"]);R!=null&&s(t,["required"],R);const k=l(e,["title"]);k!=null&&s(t,["title"],k);const F=l(e,["type"]);return F!=null&&s(t,["type"],F),t}function pi(o,e){const t={},n=l(e,["method"]);n!=null&&s(t,["method"],n);const i=l(e,["category"]);i!=null&&s(t,["category"],i);const r=l(e,["threshold"]);return r!=null&&s(t,["threshold"],r),t}function hi(o,e){const t={},n=l(e,["response"]);n!=null&&s(t,["response"],fn(o,n));const i=l(e,["description"]);i!=null&&s(t,["description"],i);const r=l(e,["name"]);r!=null&&s(t,["name"],r);const u=l(e,["parameters"]);return u!=null&&s(t,["parameters"],u),t}function mi(){return{}}function gi(o,e){const t={},n=l(e,["mode"]);n!=null&&s(t,["mode"],n);const i=l(e,["dynamicThreshold"]);return i!=null&&s(t,["dynamicThreshold"],i),t}function yi(o,e){const t={},n=l(e,["dynamicRetrievalConfig"]);return n!=null&&s(t,["dynamicRetrievalConfig"],gi(o,n)),t}function Oe(o,e){const t={},n=l(e,["functionDeclarations"]);n!=null&&(Array.isArray(n)?s(t,["functionDeclarations"],n.map(c=>hi(o,c))):s(t,["functionDeclarations"],n));const i=l(e,["retrieval"]);i!=null&&s(t,["retrieval"],i),l(e,["googleSearch"])!=null&&s(t,["googleSearch"],mi());const u=l(e,["googleSearchRetrieval"]);u!=null&&s(t,["googleSearchRetrieval"],yi(o,u));const a=l(e,["codeExecution"]);return a!=null&&s(t,["codeExecution"],a),t}function Ci(o,e){const t={},n=l(e,["mode"]);n!=null&&s(t,["mode"],n);const i=l(e,["allowedFunctionNames"]);return i!=null&&s(t,["allowedFunctionNames"],i),t}function Ti(o,e){const t={},n=l(e,["functionCallingConfig"]);return n!=null&&s(t,["functionCallingConfig"],Ci(o,n)),t}function vi(o,e){const t={},n=l(e,["voiceName"]);return n!=null&&s(t,["voiceName"],n),t}function xi(o,e){const t={},n=l(e,["prebuiltVoiceConfig"]);return n!=null&&s(t,["prebuiltVoiceConfig"],vi(o,n)),t}function Ei(o,e){const t={},n=l(e,["voiceConfig"]);return n!=null&&s(t,["voiceConfig"],xi(o,n)),t}function wi(o,e){const t={},n=l(e,["includeThoughts"]);return n!=null&&s(t,["includeThoughts"],n),t}function Si(o,e,t){const n={},i=l(e,["systemInstruction"]);t!==void 0&&i!=null&&s(t,["systemInstruction"],K(o,D(o,i)));const r=l(e,["temperature"]);r!=null&&s(n,["temperature"],r);const u=l(e,["topP"]);u!=null&&s(n,["topP"],u);const a=l(e,["topK"]);a!=null&&s(n,["topK"],a);const c=l(e,["candidateCount"]);c!=null&&s(n,["candidateCount"],c);const d=l(e,["maxOutputTokens"]);d!=null&&s(n,["maxOutputTokens"],d);const f=l(e,["stopSequences"]);f!=null&&s(n,["stopSequences"],f);const p=l(e,["responseLogprobs"]);p!=null&&s(n,["responseLogprobs"],p);const h=l(e,["logprobs"]);h!=null&&s(n,["logprobs"],h);const g=l(e,["presencePenalty"]);g!=null&&s(n,["presencePenalty"],g);const m=l(e,["frequencyPenalty"]);m!=null&&s(n,["frequencyPenalty"],m);const y=l(e,["seed"]);y!=null&&s(n,["seed"],y);const C=l(e,["responseMimeType"]);C!=null&&s(n,["responseMimeType"],C);const v=l(e,["responseSchema"]);v!=null&&s(n,["responseSchema"],fn(o,on(o,v)));const T=l(e,["routingConfig"]);T!=null&&s(n,["routingConfig"],T);const x=l(e,["safetySettings"]);t!==void 0&&x!=null&&(Array.isArray(x)?s(t,["safetySettings"],x.map(ke=>pi(o,ke))):s(t,["safetySettings"],x));const I=l(e,["tools"]);t!==void 0&&I!=null&&(Array.isArray(I)?s(t,["tools"],Q(o,Q(o,I).map(ke=>Oe(o,sn(o,ke))))):s(t,["tools"],Q(o,I)));const M=l(e,["toolConfig"]);t!==void 0&&M!=null&&s(t,["toolConfig"],Ti(o,M));const R=l(e,["labels"]);t!==void 0&&R!=null&&s(t,["labels"],R);const k=l(e,["cachedContent"]);t!==void 0&&k!=null&&s(t,["cachedContent"],$(o,k));const F=l(e,["responseModalities"]);F!=null&&s(n,["responseModalities"],F);const te=l(e,["mediaResolution"]);te!=null&&s(n,["mediaResolution"],te);const J=l(e,["speechConfig"]);J!=null&&s(n,["speechConfig"],Ei(o,rn(o,J)));const nt=l(e,["audioTimestamp"]);nt!=null&&s(n,["audioTimestamp"],nt);const ot=l(e,["thinkingConfig"]);return ot!=null&&s(n,["thinkingConfig"],wi(o,ot)),n}function Vt(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["_url","model"],b(o,n));const i=l(e,["contents"]);i!=null&&(Array.isArray(i)?s(t,["contents"],A(o,A(o,i).map(u=>K(o,u)))):s(t,["contents"],A(o,i)));const r=l(e,["config"]);return r!=null&&s(t,["generationConfig"],Si(o,r,t)),t}function _i(o,e,t){const n={},i=l(e,["taskType"]);t!==void 0&&i!=null&&s(t,["instances[]","task_type"],i);const r=l(e,["title"]);t!==void 0&&r!=null&&s(t,["instances[]","title"],r);const u=l(e,["outputDimensionality"]);t!==void 0&&u!=null&&s(t,["parameters","outputDimensionality"],u);const a=l(e,["mimeType"]);t!==void 0&&a!=null&&s(t,["instances[]","mimeType"],a);const c=l(e,["autoTruncate"]);return t!==void 0&&c!=null&&s(t,["parameters","autoTruncate"],c),n}function Ai(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["_url","model"],b(o,n));const i=l(e,["contents"]);i!=null&&s(t,["instances[]","content"],nn(o,i));const r=l(e,["config"]);return r!=null&&s(t,["config"],_i(o,r,t)),t}function Ii(o,e,t){const n={},i=l(e,["outputGcsUri"]);t!==void 0&&i!=null&&s(t,["parameters","storageUri"],i);const r=l(e,["negativePrompt"]);t!==void 0&&r!=null&&s(t,["parameters","negativePrompt"],r);const u=l(e,["numberOfImages"]);t!==void 0&&u!=null&&s(t,["parameters","sampleCount"],u);const a=l(e,["aspectRatio"]);t!==void 0&&a!=null&&s(t,["parameters","aspectRatio"],a);const c=l(e,["guidanceScale"]);t!==void 0&&c!=null&&s(t,["parameters","guidanceScale"],c);const d=l(e,["seed"]);t!==void 0&&d!=null&&s(t,["parameters","seed"],d);const f=l(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&s(t,["parameters","safetySetting"],f);const p=l(e,["personGeneration"]);t!==void 0&&p!=null&&s(t,["parameters","personGeneration"],p);const h=l(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&s(t,["parameters","includeSafetyAttributes"],h);const g=l(e,["includeRaiReason"]);t!==void 0&&g!=null&&s(t,["parameters","includeRaiReason"],g);const m=l(e,["language"]);t!==void 0&&m!=null&&s(t,["parameters","language"],m);const y=l(e,["outputMimeType"]);t!==void 0&&y!=null&&s(t,["parameters","outputOptions","mimeType"],y);const C=l(e,["outputCompressionQuality"]);t!==void 0&&C!=null&&s(t,["parameters","outputOptions","compressionQuality"],C);const v=l(e,["addWatermark"]);t!==void 0&&v!=null&&s(t,["parameters","addWatermark"],v);const T=l(e,["enhancePrompt"]);return t!==void 0&&T!=null&&s(t,["parameters","enhancePrompt"],T),n}function Ri(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["_url","model"],b(o,n));const i=l(e,["prompt"]);i!=null&&s(t,["instances[0]","prompt"],i);const r=l(e,["config"]);return r!=null&&s(t,["config"],Ii(o,r,t)),t}function ki(o,e,t){const n={},i=l(e,["systemInstruction"]);t!==void 0&&i!=null&&s(t,["systemInstruction"],K(o,D(o,i)));const r=l(e,["tools"]);t!==void 0&&r!=null&&(Array.isArray(r)?s(t,["tools"],r.map(a=>Oe(o,a))):s(t,["tools"],r));const u=l(e,["generationConfig"]);return t!==void 0&&u!=null&&s(t,["generationConfig"],u),n}function Mi(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["_url","model"],b(o,n));const i=l(e,["contents"]);i!=null&&(Array.isArray(i)?s(t,["contents"],A(o,A(o,i).map(u=>K(o,u)))):s(t,["contents"],A(o,i)));const r=l(e,["config"]);return r!=null&&s(t,["config"],ki(o,r,t)),t}function Pi(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["_url","model"],b(o,n));const i=l(e,["contents"]);i!=null&&(Array.isArray(i)?s(t,["contents"],A(o,A(o,i).map(u=>K(o,u)))):s(t,["contents"],A(o,i)));const r=l(e,["config"]);return r!=null&&s(t,["config"],r),t}function Ni(o,e){const t={},n=l(e,["gcsUri"]);n!=null&&s(t,["gcsUri"],n);const i=l(e,["imageBytes"]);i!=null&&s(t,["bytesBase64Encoded"],B(o,i));const r=l(e,["mimeType"]);return r!=null&&s(t,["mimeType"],r),t}function bi(o,e,t){const n={},i=l(e,["numberOfVideos"]);t!==void 0&&i!=null&&s(t,["parameters","sampleCount"],i);const r=l(e,["outputGcsUri"]);t!==void 0&&r!=null&&s(t,["parameters","storageUri"],r);const u=l(e,["fps"]);t!==void 0&&u!=null&&s(t,["parameters","fps"],u);const a=l(e,["durationSeconds"]);t!==void 0&&a!=null&&s(t,["parameters","durationSeconds"],a);const c=l(e,["seed"]);t!==void 0&&c!=null&&s(t,["parameters","seed"],c);const d=l(e,["aspectRatio"]);t!==void 0&&d!=null&&s(t,["parameters","aspectRatio"],d);const f=l(e,["resolution"]);t!==void 0&&f!=null&&s(t,["parameters","resolution"],f);const p=l(e,["personGeneration"]);t!==void 0&&p!=null&&s(t,["parameters","personGeneration"],p);const h=l(e,["pubsubTopic"]);t!==void 0&&h!=null&&s(t,["parameters","pubsubTopic"],h);const g=l(e,["negativePrompt"]);t!==void 0&&g!=null&&s(t,["parameters","negativePrompt"],g);const m=l(e,["enhancePrompt"]);return t!==void 0&&m!=null&&s(t,["parameters","enhancePrompt"],m),n}function Di(o,e){const t={},n=l(e,["model"]);n!=null&&s(t,["_url","model"],b(o,n));const i=l(e,["prompt"]);i!=null&&s(t,["instances[0]","prompt"],i);const r=l(e,["image"]);r!=null&&s(t,["instances[0]","image"],Ni(o,r));const u=l(e,["config"]);return u!=null&&s(t,["config"],bi(o,u,t)),t}function Li(o,e){const t={},n=l(e,["thought"]);n!=null&&s(t,["thought"],n);const i=l(e,["codeExecutionResult"]);i!=null&&s(t,["codeExecutionResult"],i);const r=l(e,["executableCode"]);r!=null&&s(t,["executableCode"],r);const u=l(e,["fileData"]);u!=null&&s(t,["fileData"],u);const a=l(e,["functionCall"]);a!=null&&s(t,["functionCall"],a);const c=l(e,["functionResponse"]);c!=null&&s(t,["functionResponse"],c);const d=l(e,["inlineData"]);d!=null&&s(t,["inlineData"],d);const f=l(e,["text"]);return f!=null&&s(t,["text"],f),t}function pn(o,e){const t={},n=l(e,["parts"]);n!=null&&(Array.isArray(n)?s(t,["parts"],n.map(r=>Li(o,r))):s(t,["parts"],n));const i=l(e,["role"]);return i!=null&&s(t,["role"],i),t}function Fi(o,e){const t={},n=l(e,["citationSources"]);return n!=null&&s(t,["citations"],n),t}function qi(o,e){const t={},n=l(e,["content"]);n!=null&&s(t,["content"],pn(o,n));const i=l(e,["citationMetadata"]);i!=null&&s(t,["citationMetadata"],Fi(o,i));const r=l(e,["tokenCount"]);r!=null&&s(t,["tokenCount"],r);const u=l(e,["finishReason"]);u!=null&&s(t,["finishReason"],u);const a=l(e,["avgLogprobs"]);a!=null&&s(t,["avgLogprobs"],a);const c=l(e,["groundingMetadata"]);c!=null&&s(t,["groundingMetadata"],c);const d=l(e,["index"]);d!=null&&s(t,["index"],d);const f=l(e,["logprobsResult"]);f!=null&&s(t,["logprobsResult"],f);const p=l(e,["safetyRatings"]);return p!=null&&s(t,["safetyRatings"],p),t}function Ut(o,e){const t={},n=l(e,["candidates"]);n!=null&&(Array.isArray(n)?s(t,["candidates"],n.map(a=>qi(o,a))):s(t,["candidates"],n));const i=l(e,["modelVersion"]);i!=null&&s(t,["modelVersion"],i);const r=l(e,["promptFeedback"]);r!=null&&s(t,["promptFeedback"],r);const u=l(e,["usageMetadata"]);return u!=null&&s(t,["usageMetadata"],u),t}function Vi(o,e){const t={},n=l(e,["values"]);return n!=null&&s(t,["values"],n),t}function Ui(){return{}}function Gi(o,e){const t={},n=l(e,["embeddings"]);return n!=null&&(Array.isArray(n)?s(t,["embeddings"],n.map(r=>Vi(o,r))):s(t,["embeddings"],n)),l(e,["metadata"])!=null&&s(t,["metadata"],Ui()),t}function $i(o,e){const t={},n=l(e,["bytesBase64Encoded"]);n!=null&&s(t,["imageBytes"],B(o,n));const i=l(e,["mimeType"]);return i!=null&&s(t,["mimeType"],i),t}function hn(o,e){const t={},n=l(e,["safetyAttributes","categories"]);n!=null&&s(t,["categories"],n);const i=l(e,["safetyAttributes","scores"]);i!=null&&s(t,["scores"],i);const r=l(e,["contentType"]);return r!=null&&s(t,["contentType"],r),t}function Bi(o,e){const t={},n=l(e,["_self"]);n!=null&&s(t,["image"],$i(o,n));const i=l(e,["raiFilteredReason"]);i!=null&&s(t,["raiFilteredReason"],i);const r=l(e,["_self"]);return r!=null&&s(t,["safetyAttributes"],hn(o,r)),t}function Hi(o,e){const t={},n=l(e,["predictions"]);n!=null&&(Array.isArray(n)?s(t,["generatedImages"],n.map(r=>Bi(o,r))):s(t,["generatedImages"],n));const i=l(e,["positivePromptSafetyAttributes"]);return i!=null&&s(t,["positivePromptSafetyAttributes"],hn(o,i)),t}function Oi(o,e){const t={},n=l(e,["totalTokens"]);n!=null&&s(t,["totalTokens"],n);const i=l(e,["cachedContentTokenCount"]);return i!=null&&s(t,["cachedContentTokenCount"],i),t}function zi(o,e){const t={},n=l(e,["video","uri"]);n!=null&&s(t,["uri"],n);const i=l(e,["video","encodedVideo"]);i!=null&&s(t,["videoBytes"],B(o,i));const r=l(e,["encoding"]);return r!=null&&s(t,["mimeType"],r),t}function Yi(o,e){const t={},n=l(e,["_self"]);return n!=null&&s(t,["video"],zi(o,n)),t}function Ki(o,e){const t={},n=l(e,["generatedSamples"]);n!=null&&(Array.isArray(n)?s(t,["generatedVideos"],n.map(u=>Yi(o,u))):s(t,["generatedVideos"],n));const i=l(e,["raiMediaFilteredCount"]);i!=null&&s(t,["raiMediaFilteredCount"],i);const r=l(e,["raiMediaFilteredReasons"]);return r!=null&&s(t,["raiMediaFilteredReasons"],r),t}function Wi(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["name"],n);const i=l(e,["metadata"]);i!=null&&s(t,["metadata"],i);const r=l(e,["done"]);r!=null&&s(t,["done"],r);const u=l(e,["error"]);u!=null&&s(t,["error"],u);const a=l(e,["response"]);a!=null&&s(t,["response"],a);const c=l(e,["response","generateVideoResponse"]);return c!=null&&s(t,["result"],Ki(o,c)),t}function Ji(o,e){const t={},n=l(e,["videoMetadata"]);n!=null&&s(t,["videoMetadata"],n);const i=l(e,["thought"]);i!=null&&s(t,["thought"],i);const r=l(e,["codeExecutionResult"]);r!=null&&s(t,["codeExecutionResult"],r);const u=l(e,["executableCode"]);u!=null&&s(t,["executableCode"],u);const a=l(e,["fileData"]);a!=null&&s(t,["fileData"],a);const c=l(e,["functionCall"]);c!=null&&s(t,["functionCall"],c);const d=l(e,["functionResponse"]);d!=null&&s(t,["functionResponse"],d);const f=l(e,["inlineData"]);f!=null&&s(t,["inlineData"],f);const p=l(e,["text"]);return p!=null&&s(t,["text"],p),t}function mn(o,e){const t={},n=l(e,["parts"]);n!=null&&(Array.isArray(n)?s(t,["parts"],n.map(r=>Ji(o,r))):s(t,["parts"],n));const i=l(e,["role"]);return i!=null&&s(t,["role"],i),t}function Xi(o,e){const t={},n=l(e,["citations"]);return n!=null&&s(t,["citations"],n),t}function Zi(o,e){const t={},n=l(e,["content"]);n!=null&&s(t,["content"],mn(o,n));const i=l(e,["citationMetadata"]);i!=null&&s(t,["citationMetadata"],Xi(o,i));const r=l(e,["finishMessage"]);r!=null&&s(t,["finishMessage"],r);const u=l(e,["finishReason"]);u!=null&&s(t,["finishReason"],u);const a=l(e,["avgLogprobs"]);a!=null&&s(t,["avgLogprobs"],a);const c=l(e,["groundingMetadata"]);c!=null&&s(t,["groundingMetadata"],c);const d=l(e,["index"]);d!=null&&s(t,["index"],d);const f=l(e,["logprobsResult"]);f!=null&&s(t,["logprobsResult"],f);const p=l(e,["safetyRatings"]);return p!=null&&s(t,["safetyRatings"],p),t}function Gt(o,e){const t={},n=l(e,["candidates"]);n!=null&&(Array.isArray(n)?s(t,["candidates"],n.map(d=>Zi(o,d))):s(t,["candidates"],n));const i=l(e,["createTime"]);i!=null&&s(t,["createTime"],i);const r=l(e,["responseId"]);r!=null&&s(t,["responseId"],r);const u=l(e,["modelVersion"]);u!=null&&s(t,["modelVersion"],u);const a=l(e,["promptFeedback"]);a!=null&&s(t,["promptFeedback"],a);const c=l(e,["usageMetadata"]);return c!=null&&s(t,["usageMetadata"],c),t}function Qi(o,e){const t={},n=l(e,["truncated"]);n!=null&&s(t,["truncated"],n);const i=l(e,["token_count"]);return i!=null&&s(t,["tokenCount"],i),t}function ji(o,e){const t={},n=l(e,["values"]);n!=null&&s(t,["values"],n);const i=l(e,["statistics"]);return i!=null&&s(t,["statistics"],Qi(o,i)),t}function er(o,e){const t={},n=l(e,["billableCharacterCount"]);return n!=null&&s(t,["billableCharacterCount"],n),t}function tr(o,e){const t={},n=l(e,["predictions[]","embeddings"]);n!=null&&(Array.isArray(n)?s(t,["embeddings"],n.map(r=>ji(o,r))):s(t,["embeddings"],n));const i=l(e,["metadata"]);return i!=null&&s(t,["metadata"],er(o,i)),t}function nr(o,e){const t={},n=l(e,["gcsUri"]);n!=null&&s(t,["gcsUri"],n);const i=l(e,["bytesBase64Encoded"]);i!=null&&s(t,["imageBytes"],B(o,i));const r=l(e,["mimeType"]);return r!=null&&s(t,["mimeType"],r),t}function gn(o,e){const t={},n=l(e,["safetyAttributes","categories"]);n!=null&&s(t,["categories"],n);const i=l(e,["safetyAttributes","scores"]);i!=null&&s(t,["scores"],i);const r=l(e,["contentType"]);return r!=null&&s(t,["contentType"],r),t}function or(o,e){const t={},n=l(e,["_self"]);n!=null&&s(t,["image"],nr(o,n));const i=l(e,["raiFilteredReason"]);i!=null&&s(t,["raiFilteredReason"],i);const r=l(e,["_self"]);r!=null&&s(t,["safetyAttributes"],gn(o,r));const u=l(e,["prompt"]);return u!=null&&s(t,["enhancedPrompt"],u),t}function ir(o,e){const t={},n=l(e,["predictions"]);n!=null&&(Array.isArray(n)?s(t,["generatedImages"],n.map(r=>or(o,r))):s(t,["generatedImages"],n));const i=l(e,["positivePromptSafetyAttributes"]);return i!=null&&s(t,["positivePromptSafetyAttributes"],gn(o,i)),t}function rr(o,e){const t={},n=l(e,["totalTokens"]);return n!=null&&s(t,["totalTokens"],n),t}function sr(o,e){const t={},n=l(e,["tokensInfo"]);return n!=null&&s(t,["tokensInfo"],n),t}function lr(o,e){const t={},n=l(e,["gcsUri"]);n!=null&&s(t,["uri"],n);const i=l(e,["bytesBase64Encoded"]);i!=null&&s(t,["videoBytes"],B(o,i));const r=l(e,["mimeType"]);return r!=null&&s(t,["mimeType"],r),t}function ar(o,e){const t={},n=l(e,["_self"]);return n!=null&&s(t,["video"],lr(o,n)),t}function ur(o,e){const t={},n=l(e,["videos"]);n!=null&&(Array.isArray(n)?s(t,["generatedVideos"],n.map(u=>ar(o,u))):s(t,["generatedVideos"],n));const i=l(e,["raiMediaFilteredCount"]);i!=null&&s(t,["raiMediaFilteredCount"],i);const r=l(e,["raiMediaFilteredReasons"]);return r!=null&&s(t,["raiMediaFilteredReasons"],r),t}function cr(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["name"],n);const i=l(e,["metadata"]);i!=null&&s(t,["metadata"],i);const r=l(e,["done"]);r!=null&&s(t,["done"],r);const u=l(e,["error"]);u!=null&&s(t,["error"],u);const a=l(e,["response"]);a!=null&&s(t,["response"],a);const c=l(e,["response"]);return c!=null&&s(t,["result"],ur(o,c)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dr(o,e){const t={},n=l(e,["config"]);n!=null&&s(t,["setup"],mr(o,n));const i=l(e,["model"]);return i!==void 0&&s(t,["setup","model"],i),t}function fr(o,e){const t={},n=l(e,["config"]);n!=null&&s(t,["setup"],gr(o,n));const i=l(e,["model"]);return i!==void 0&&s(t,["setup","model"],i),t}function pr(o,e){const t={},n=l(e,["setupComplete"]);n!==void 0&&s(t,["setupComplete"],n);const i=l(e,["serverContent"]);i!=null&&s(t,["serverContent"],yr(o,i));const r=l(e,["toolCall"]);r!=null&&s(t,["toolCall"],xr(o,r));const u=l(e,["toolCallCancellation"]);return u!=null&&s(t,["toolCallCancellation"],wr(o,u)),t}function hr(o,e){const t={},n=l(e,["setupComplete"]);n!==void 0&&s(t,["setupComplete"],n);const i=l(e,["serverContent"]);i!=null&&s(t,["serverContent"],Cr(o,i));const r=l(e,["toolCall"]);r!=null&&s(t,["toolCall"],Er(o,r));const u=l(e,["toolCallCancellation"]);return u!=null&&s(t,["toolCallCancellation"],Sr(o,u)),t}function mr(o,e){const t={},n=l(e,["generationConfig"]);n!==void 0&&s(t,["generationConfig"],n);const i=l(e,["responseModalities"]);i!==void 0&&s(t,["generationConfig","responseModalities"],i);const r=l(e,["speechConfig"]);r!==void 0&&s(t,["generationConfig","speechConfig"],r);const u=l(e,["systemInstruction"]);u!=null&&s(t,["systemInstruction"],ue(o,u));const a=l(e,["tools"]);return a!=null&&Array.isArray(a)&&s(t,["tools"],a.map(c=>dn(o,c))),t}function gr(o,e){const t={},n=l(e,["generationConfig"]);n!==void 0&&s(t,["generationConfig"],n);const i=l(e,["responseModalities"]);i!==void 0?s(t,["generationConfig","responseModalities"],i):s(t,["generationConfig","responseModalities"],["AUDIO"]);const r=l(e,["speechConfig"]);r!==void 0&&s(t,["generationConfig","speechConfig"],r);const u=l(e,["systemInstruction"]);u!=null&&s(t,["systemInstruction"],K(o,u));const a=l(e,["tools"]);return a!=null&&Array.isArray(a)&&s(t,["tools"],a.map(c=>Oe(o,c))),t}function yr(o,e){const t={},n=l(e,["modelTurn"]);n!=null&&s(t,["modelTurn"],pn(o,n));const i=l(e,["turnComplete"]);i!==void 0&&s(t,["turnComplete"],i);const r=l(e,["interrupted"]);return r!==void 0&&s(t,["interrupted"],r),t}function Cr(o,e){const t={},n=l(e,["modelTurn"]);n!=null&&s(t,["modelTurn"],mn(o,n));const i=l(e,["turnComplete"]);i!==void 0&&s(t,["turnComplete"],i);const r=l(e,["interrupted"]);return r!==void 0&&s(t,["interrupted"],r),t}function Tr(o,e){const t={},n=l(e,["id"]);n!==void 0&&s(t,["id"],n);const i=l(e,["args"]);i!==void 0&&s(t,["args"],i);const r=l(e,["name"]);return r!==void 0&&s(t,["name"],r),t}function vr(o,e){const t={},n=l(e,["args"]);n!==void 0&&s(t,["args"],n);const i=l(e,["name"]);return i!==void 0&&s(t,["name"],i),t}function xr(o,e){const t={},n=l(e,["functionCalls"]);return n!=null&&Array.isArray(n)&&s(t,["functionCalls"],n.map(i=>Tr(o,i))),t}function Er(o,e){const t={},n=l(e,["functionCalls"]);return n!=null&&Array.isArray(n)&&s(t,["functionCalls"],n.map(i=>vr(o,i))),t}function wr(o,e){const t={},n=l(e,["ids"]);return n!==void 0&&s(t,["ids"],n),t}function Sr(o,e){const t={},n=l(e,["ids"]);return n!==void 0&&s(t,["ids"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _r="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Ar(o,e,t){let n,i;t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),o.isVertexAI()?n=hr(o,i):n=pr(o,i),e(n)}class Ir{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;const i=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion();let u;const a=Pr(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())u=`${i}/ws/google.cloud.aiplatform.${r}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(a);else{const T=this.apiClient.getApiKey();u=`${i}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateContent?key=${T}`}let c=()=>{};const d=new Promise(T=>{c=T}),f=e.callbacks,p=function(){var T;(T=f==null?void 0:f.onopen)===null||T===void 0||T.call(f),c({})},h=this.apiClient,g={onopen:p,onmessage:T=>{Ar(h,f.onmessage,T)},onerror:(t=f==null?void 0:f.onerror)!==null&&t!==void 0?t:function(T){},onclose:(n=f==null?void 0:f.onclose)!==null&&n!==void 0?n:function(T){}},m=this.webSocketFactory.create(u,Mr(a),g);m.connect(),await d;let y=b(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&y.startsWith("publishers/")){const T=this.apiClient.getProject(),x=this.apiClient.getLocation();y=`projects/${T}/locations/${x}/`+y}let C={};const v={model:y,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?C=fr(this.apiClient,v):C=dr(this.apiClient,v),m.send(JSON.stringify(C)),new kr(m,this.apiClient)}}const Rr={turnComplete:!0};class kr{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=A(e,t.turns),e.isVertexAI()?n=n.map(i=>K(e,i)):n=n.map(i=>ue(e,i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClientRealtimeInput(e,t){let n={};if(!("media"in t)||!t.media)throw new Error(`Failed to convert realtime input "media", type: '${typeof t.media}'`);return n={realtimeInput:{mediaChunks:[t.media]}},n}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const r of n){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(_r)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},Rr),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){if(e.media==null)throw new Error("Media is required.");const t=this.tLiveClientRealtimeInput(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Mr(o){const e={};return o.forEach((t,n)=>{e[n]=t}),e}function Pr(o){const e=new Headers;for(const[t,n]of Object.entries(o))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Nr extends Ae{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var i;let r;const u=[];if(n!=null&&n.generatedImages)for(const c of n.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((i=c==null?void 0:c.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?r=c==null?void 0:c.safetyAttributes:u.push(c);let a;return r?a={generatedImages:u,positivePromptSafetyAttributes:r}:a={generatedImages:u},a})}async generateContentInternal(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=Vt(this.apiClient,e);return r=E("{model}:generateContent",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>{const d=Gt(this.apiClient,c),f=new de;return Object.assign(f,d),f})}else{const a=qt(this.apiClient,e);return r=E("{model}:generateContent",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>{const d=Ut(this.apiClient,c),f=new de;return Object.assign(f,d),f})}}async generateContentStreamInternal(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=Vt(this.apiClient,e);r=E("{model}:streamGenerateContent?alt=sse",a._url),u=a._query,delete a.config,delete a._url,delete a._query;const c=this.apiClient;return i=c.requestStream({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}),i.then(function(d){return xe(this,arguments,function*(){var f,p,h,g;try{for(var m=!0,y=Pe(d),C;C=yield N(y.next()),f=C.done,!f;m=!0){g=C.value,m=!1;const T=Gt(c,g),x=new de;Object.assign(x,T),yield yield N(x)}}catch(v){p={error:v}}finally{try{!m&&!f&&(h=y.return)&&(yield N(h.call(y)))}finally{if(p)throw p.error}}})})}else{const a=qt(this.apiClient,e);r=E("{model}:streamGenerateContent?alt=sse",a._url),u=a._query,delete a.config,delete a._url,delete a._query;const c=this.apiClient;return i=c.requestStream({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}),i.then(function(d){return xe(this,arguments,function*(){var f,p,h,g;try{for(var m=!0,y=Pe(d),C;C=yield N(y.next()),f=C.done,!f;m=!0){g=C.value,m=!1;const T=Ut(c,g),x=new de;Object.assign(x,T),yield yield N(x)}}catch(v){p={error:v}}finally{try{!m&&!f&&(h=y.return)&&(yield N(h.call(y)))}finally{if(p)throw p.error}}})})}}async embedContent(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=Ai(this.apiClient,e);return r=E("{model}:predict",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>{const d=tr(this.apiClient,c),f=new Pt;return Object.assign(f,d),f})}else{const a=ii(this.apiClient,e);return r=E("{model}:batchEmbedContents",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>{const d=Gi(this.apiClient,c),f=new Pt;return Object.assign(f,d),f})}}async generateImagesInternal(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=Ri(this.apiClient,e);return r=E("{model}:predict",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>{const d=ir(this.apiClient,c),f=new Nt;return Object.assign(f,d),f})}else{const a=si(this.apiClient,e);return r=E("{model}:predict",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>{const d=Hi(this.apiClient,c),f=new Nt;return Object.assign(f,d),f})}}async countTokens(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=Mi(this.apiClient,e);return r=E("{model}:countTokens",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>{const d=rr(this.apiClient,c),f=new bt;return Object.assign(f,d),f})}else{const a=ai(this.apiClient,e);return r=E("{model}:countTokens",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>{const d=Oi(this.apiClient,c),f=new bt;return Object.assign(f,d),f})}}async computeTokens(e){var t;let n,i="",r={};if(this.apiClient.isVertexAI()){const u=Pi(this.apiClient,e);return i=E("{model}:computeTokens",u._url),r=u._query,delete u.config,delete u._url,delete u._query,n=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(a=>a.json()),n.then(a=>{const c=sr(this.apiClient,a),d=new xo;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=Di(this.apiClient,e);return r=E("{model}:predictLongRunning",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>cr(this.apiClient,c))}else{const a=di(this.apiClient,e);return r=E("{model}:predictLongRunning",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>Wi(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function br(o,e){const t={},n=l(e,["operationName"]);n!=null&&s(t,["_url","operationName"],n);const i=l(e,["config"]);return i!=null&&s(t,["config"],i),t}function Dr(o,e){const t={},n=l(e,["operationName"]);n!=null&&s(t,["_url","operationName"],n);const i=l(e,["config"]);return i!=null&&s(t,["config"],i),t}function Lr(o,e){const t={},n=l(e,["operationName"]);n!=null&&s(t,["operationName"],n);const i=l(e,["resourceName"]);i!=null&&s(t,["_url","resourceName"],i);const r=l(e,["config"]);return r!=null&&s(t,["config"],r),t}function Fr(o,e){const t={},n=l(e,["video","uri"]);n!=null&&s(t,["uri"],n);const i=l(e,["video","encodedVideo"]);i!=null&&s(t,["videoBytes"],B(o,i));const r=l(e,["encoding"]);return r!=null&&s(t,["mimeType"],r),t}function qr(o,e){const t={},n=l(e,["_self"]);return n!=null&&s(t,["video"],Fr(o,n)),t}function Vr(o,e){const t={},n=l(e,["generatedSamples"]);n!=null&&(Array.isArray(n)?s(t,["generatedVideos"],n.map(u=>qr(o,u))):s(t,["generatedVideos"],n));const i=l(e,["raiMediaFilteredCount"]);i!=null&&s(t,["raiMediaFilteredCount"],i);const r=l(e,["raiMediaFilteredReasons"]);return r!=null&&s(t,["raiMediaFilteredReasons"],r),t}function Ur(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["name"],n);const i=l(e,["metadata"]);i!=null&&s(t,["metadata"],i);const r=l(e,["done"]);r!=null&&s(t,["done"],r);const u=l(e,["error"]);u!=null&&s(t,["error"],u);const a=l(e,["response"]);a!=null&&s(t,["response"],a);const c=l(e,["response","generateVideoResponse"]);return c!=null&&s(t,["result"],Vr(o,c)),t}function Gr(o,e){const t={},n=l(e,["gcsUri"]);n!=null&&s(t,["uri"],n);const i=l(e,["bytesBase64Encoded"]);i!=null&&s(t,["videoBytes"],B(o,i));const r=l(e,["mimeType"]);return r!=null&&s(t,["mimeType"],r),t}function $r(o,e){const t={},n=l(e,["_self"]);return n!=null&&s(t,["video"],Gr(o,n)),t}function Br(o,e){const t={},n=l(e,["videos"]);n!=null&&(Array.isArray(n)?s(t,["generatedVideos"],n.map(u=>$r(o,u))):s(t,["generatedVideos"],n));const i=l(e,["raiMediaFilteredCount"]);i!=null&&s(t,["raiMediaFilteredCount"],i);const r=l(e,["raiMediaFilteredReasons"]);return r!=null&&s(t,["raiMediaFilteredReasons"],r),t}function $t(o,e){const t={},n=l(e,["name"]);n!=null&&s(t,["name"],n);const i=l(e,["metadata"]);i!=null&&s(t,["metadata"],i);const r=l(e,["done"]);r!=null&&s(t,["done"],r);const u=l(e,["error"]);u!=null&&s(t,["error"],u);const a=l(e,["response"]);a!=null&&s(t,["response"],a);const c=l(e,["response"]);return c!=null&&s(t,["result"],Br(o,c)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hr extends Ae{constructor(e){super(),this.apiClient=e}async get(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];var i=void 0;return n&&"httpOptions"in n&&(i=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:t.name,config:n})}async getVideosOperationInternal(e){var t,n;let i,r="",u={};if(this.apiClient.isVertexAI()){const a=Dr(this.apiClient,e);return r=E("{operationName}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>$t(this.apiClient,c))}else{const a=br(this.apiClient,e);return r=E("{operationName}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>Ur(this.apiClient,c))}}async fetchPredictVideosOperationInternal(e){var t;let n,i="",r={};if(this.apiClient.isVertexAI()){const u=Lr(this.apiClient,e);return i=E("{resourceName}:fetchPredictOperation",u._url),r=u._query,delete u.config,delete u._url,delete u._query,n=this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions}).then(a=>a.json()),n.then(a=>$t(this.apiClient,a))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Or="Content-Type",zr="User-Agent",Yr="x-goog-api-client",Kr="0.7.0",Wr=`google-genai-sdk/${Kr}`,Jr="v1beta1",Xr="v1beta",Bt=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Zr extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class Ht extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class Qr{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:Jr,this.getProject()||this.getLocation()?(i.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`,this.clientOptions.apiKey=void 0):(i.baseUrl="https://aiplatform.googleapis.com/",this.clientOptions.project=void 0,this.clientOptions.location=void 0)):(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Xr,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol="wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t){const n=[this.getRequestUrlInternal(t)];return this.clientOptions.vertexai&&!this.clientOptions.apiKey&&!e.startsWith("projects/")&&n.push(this.getBaseResourcePath()),e!==""&&n.push(e),new URL(`${n.join("/")}`)}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.constructUrl(e.path,t);if(e.queryParams)for(const[r,u]of Object.entries(e.queryParams))n.searchParams.append(r,String(u));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,t),this.unaryApiCall(n,i,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[i,r]of Object.entries(t))typeof r=="object"?n[i]=Object.assign(Object.assign({},n[i]),r):r!==void 0&&(n[i]=r);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.constructUrl(e.path,t);(!n.searchParams.has("alt")||n.searchParams.get("alt")!=="sse")&&n.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,t),this.streamApiCall(n,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t){if(t&&t.timeout&&t.timeout>0){const n=new AbortController,i=n.signal;setTimeout(()=>n.abort(),t.timeout),e.signal=i}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await Ot(i),new un(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await Ot(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var t;return xe(this,arguments,function*(){const i=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),r=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let u="";for(;;){const{done:a,value:c}=yield N(i.read());if(a){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=r.decode(c);u+=d;let f=u.match(Bt);for(;f;){const p=f[1];try{const h=JSON.parse(p);yield yield N(h),u=u.slice(f[0].length),f=u.match(Bt)}catch(h){throw new Error(`exception parsing stream chunk ${p}. ${h}`)}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=Wr+" "+this.clientOptions.userAgentExtra;return e[zr]=t,e[Yr]=t,e[Or]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers)for(const[n,i]of Object.entries(e.headers))t.append(n,i);return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var n;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const r=this.clientOptions.uploader,u=await r.stat(e);i.sizeBytes=String(u.size);const a=(n=t==null?void 0:t.mimeType)!==null&&n!==void 0?n:u.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const c=await this.fetchUploadUrl(i,t);return r.upload(e,c,this)}async fetchUploadUrl(e,t){var n;let i={};t!=null&&t.httpOptions?i=t.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const r={file:e},u=await this.request({path:E("upload/v1beta/files",r._url),body:JSON.stringify(r),httpMethod:"POST",httpOptions:i});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(n=u==null?void 0:u.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function Ot(o){var e;if(o===void 0)throw new Ht("response is undefined");if(!o.ok){const t=o.status,n=o.statusText;let i;!((e=o.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await o.json():i={error:{message:"exception parsing response",code:o.status,status:o.statusText}};const r=`got status: ${t} ${n}. ${JSON.stringify(i)}`;throw t>=400&&t<500?new Zr(r):t>=500&&t<600?new Ht(r):new Error(r)}}const jr=1024*1024*8;async function es(o,e,t){var n,i;let r=0,u=0,a=new un(new Response),c="upload";for(r=o.size;u<r;){const f=Math.min(jr,r-u),p=o.slice(u,u+f);if(u+f>=r&&(c+=", finalize"),a=await t.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(u),"Content-Length":String(f)}}}),u+=f,((n=a==null?void 0:a.headers)===null||n===void 0?void 0:n["x-goog-upload-status"])!=="active")break;if(r<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const d=await(a==null?void 0:a.json());if(((i=a==null?void 0:a.headers)===null||i===void 0?void 0:i["x-goog-upload-status"])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}async function ts(o){return{size:o.size,type:o.type}}class ns{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await es(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await ts(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class os{create(e,t,n){return new is(e,t,n)}}class is{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zt="x-goog-api-key";class rs{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(zt)===null&&e.append(zt,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ss="gl-node/";class ls{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey,this.apiVersion=e.apiVersion;const n=new rs(this.apiKey);this.apiClient=new Qr({auth:n,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:ss+"web",uploader:new ns}),this.models=new Nr(this.apiClient),this.live=new Ir(this.apiClient,n,new os),this.chats=new ko(this.models,this.apiClient),this.caches=new _o(this.apiClient),this.files=new Bo(this.apiClient),this.operations=new Hr(this.apiClient)}}function ze(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var W=ze();function yn(o){W=o}var re={exec:()=>null};function S(o,e=""){let t=typeof o=="string"?o:o.source;const n={replace:(i,r)=>{let u=typeof r=="string"?r:r.source;return u=u.replace(P.caret,"$1"),t=t.replace(i,u),n},getRegex:()=>new RegExp(t,e)};return n}var P={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:o=>new RegExp(`^( {0,3}${o})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:o=>new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:o=>new RegExp(`^ {0,${Math.min(3,o-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:o=>new RegExp(`^ {0,${Math.min(3,o-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:o=>new RegExp(`^ {0,${Math.min(3,o-1)}}#`),htmlBeginRegex:o=>new RegExp(`^ {0,${Math.min(3,o-1)}}<(?:[a-z].*>|!--)`,"i")},as=/^(?:[ \t]*(?:\n|$))+/,us=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,cs=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ce=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,ds=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Ye=/(?:[*+-]|\d{1,9}[.)])/,Cn=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Tn=S(Cn).replace(/bull/g,Ye).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),fs=S(Cn).replace(/bull/g,Ye).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Ke=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ps=/^[^\n]+/,We=/(?!\s*\])(?:\\.|[^\[\]\\])+/,hs=S(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",We).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ms=S(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Ye).getRegex(),Ie="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Je=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,gs=S("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Je).replace("tag",Ie).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),vn=S(Ke).replace("hr",ce).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ie).getRegex(),ys=S(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",vn).getRegex(),Xe={blockquote:ys,code:us,def:hs,fences:cs,heading:ds,hr:ce,html:gs,lheading:Tn,list:ms,newline:as,paragraph:vn,table:re,text:ps},Yt=S("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ce).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ie).getRegex(),Cs={...Xe,lheading:fs,table:Yt,paragraph:S(Ke).replace("hr",ce).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Yt).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ie).getRegex()},Ts={...Xe,html:S(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Je).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:re,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:S(Ke).replace("hr",ce).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Tn).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},vs=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,xs=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,xn=/^( {2,}|\\)\n(?!\s*$)/,Es=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Re=/[\p{P}\p{S}]/u,Ze=/[\s\p{P}\p{S}]/u,En=/[^\s\p{P}\p{S}]/u,ws=S(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Ze).getRegex(),wn=/(?!~)[\p{P}\p{S}]/u,Ss=/(?!~)[\s\p{P}\p{S}]/u,_s=/(?:[^\s\p{P}\p{S}]|~)/u,As=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Sn=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Is=S(Sn,"u").replace(/punct/g,Re).getRegex(),Rs=S(Sn,"u").replace(/punct/g,wn).getRegex(),_n="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",ks=S(_n,"gu").replace(/notPunctSpace/g,En).replace(/punctSpace/g,Ze).replace(/punct/g,Re).getRegex(),Ms=S(_n,"gu").replace(/notPunctSpace/g,_s).replace(/punctSpace/g,Ss).replace(/punct/g,wn).getRegex(),Ps=S("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,En).replace(/punctSpace/g,Ze).replace(/punct/g,Re).getRegex(),Ns=S(/\\(punct)/,"gu").replace(/punct/g,Re).getRegex(),bs=S(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Ds=S(Je).replace("(?:-->|$)","-->").getRegex(),Ls=S("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Ds).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ee=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Fs=S(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ee).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),An=S(/^!?\[(label)\]\[(ref)\]/).replace("label",Ee).replace("ref",We).getRegex(),In=S(/^!?\[(ref)\](?:\[\])?/).replace("ref",We).getRegex(),qs=S("reflink|nolink(?!\\()","g").replace("reflink",An).replace("nolink",In).getRegex(),Qe={_backpedal:re,anyPunctuation:Ns,autolink:bs,blockSkip:As,br:xn,code:xs,del:re,emStrongLDelim:Is,emStrongRDelimAst:ks,emStrongRDelimUnd:Ps,escape:vs,link:Fs,nolink:In,punctuation:ws,reflink:An,reflinkSearch:qs,tag:Ls,text:Es,url:re},Vs={...Qe,link:S(/^!?\[(label)\]\((.*?)\)/).replace("label",Ee).getRegex(),reflink:S(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ee).getRegex()},be={...Qe,emStrongRDelimAst:Ms,emStrongLDelim:Rs,url:S(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Us={...be,br:S(xn).replace("{2,}","*").getRegex(),text:S(be.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},fe={normal:Xe,gfm:Cs,pedantic:Ts},ne={normal:Qe,gfm:be,breaks:Us,pedantic:Vs},Gs={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Kt=o=>Gs[o];function q(o,e){if(e){if(P.escapeTest.test(o))return o.replace(P.escapeReplace,Kt)}else if(P.escapeTestNoEncode.test(o))return o.replace(P.escapeReplaceNoEncode,Kt);return o}function Wt(o){try{o=encodeURI(o).replace(P.percentDecode,"%")}catch{return null}return o}function Jt(o,e){var r;const t=o.replace(P.findPipe,(u,a,c)=>{let d=!1,f=a;for(;--f>=0&&c[f]==="\\";)d=!d;return d?"|":" |"}),n=t.split(P.splitPipe);let i=0;if(n[0].trim()||n.shift(),n.length>0&&!((r=n.at(-1))!=null&&r.trim())&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(P.slashPipe,"|");return n}function oe(o,e,t){const n=o.length;if(n===0)return"";let i=0;for(;i<n&&o.charAt(n-i-1)===e;)i++;return o.slice(0,n-i)}function $s(o,e){if(o.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<o.length;n++)if(o[n]==="\\")n++;else if(o[n]===e[0])t++;else if(o[n]===e[1]&&(t--,t<0))return n;return t>0?-2:-1}function Xt(o,e,t,n,i){const r=e.href,u=e.title||null,a=o[1].replace(i.other.outputLinkReplace,"$1");n.state.inLink=!0;const c={type:o[0].charAt(0)==="!"?"image":"link",raw:t,href:r,title:u,text:a,tokens:n.inlineTokens(a)};return n.state.inLink=!1,c}function Bs(o,e,t){const n=o.match(t.other.indentCodeCompensation);if(n===null)return e;const i=n[1];return e.split(`
`).map(r=>{const u=r.match(t.other.beginningSpace);if(u===null)return r;const[a]=u;return a.length>=i.length?r.slice(i.length):r}).join(`
`)}var we=class{constructor(o){_(this,"options");_(this,"rules");_(this,"lexer");this.options=o||W}space(o){const e=this.rules.block.newline.exec(o);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(o){const e=this.rules.block.code.exec(o);if(e){const t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:oe(t,`
`)}}}fences(o){const e=this.rules.block.fences.exec(o);if(e){const t=e[0],n=Bs(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:n}}}heading(o){const e=this.rules.block.heading.exec(o);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){const n=oe(t,"#");(this.options.pedantic||!n||this.rules.other.endingSpaceChar.test(n))&&(t=n.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(o){const e=this.rules.block.hr.exec(o);if(e)return{type:"hr",raw:oe(e[0],`
`)}}blockquote(o){const e=this.rules.block.blockquote.exec(o);if(e){let t=oe(e[0],`
`).split(`
`),n="",i="";const r=[];for(;t.length>0;){let u=!1;const a=[];let c;for(c=0;c<t.length;c++)if(this.rules.other.blockquoteStart.test(t[c]))a.push(t[c]),u=!0;else if(!u)a.push(t[c]);else break;t=t.slice(c);const d=a.join(`
`),f=d.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}
${d}`:d,i=i?`${i}
${f}`:f;const p=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(f,r,!0),this.lexer.state.top=p,t.length===0)break;const h=r.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const g=h,m=g.raw+`
`+t.join(`
`),y=this.blockquote(m);r[r.length-1]=y,n=n.substring(0,n.length-g.raw.length)+y.raw,i=i.substring(0,i.length-g.text.length)+y.text;break}else if((h==null?void 0:h.type)==="list"){const g=h,m=g.raw+`
`+t.join(`
`),y=this.list(m);r[r.length-1]=y,n=n.substring(0,n.length-h.raw.length)+y.raw,i=i.substring(0,i.length-g.raw.length)+y.raw,t=m.substring(r.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:r,text:i}}}list(o){let e=this.rules.block.list.exec(o);if(e){let t=e[1].trim();const n=t.length>1,i={type:"list",raw:"",ordered:n,start:n?+t.slice(0,-1):"",loose:!1,items:[]};t=n?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=n?t:"[*+-]");const r=this.rules.other.listItemRegex(t);let u=!1;for(;o;){let c=!1,d="",f="";if(!(e=r.exec(o))||this.rules.block.hr.test(o))break;d=e[0],o=o.substring(d.length);let p=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,v=>" ".repeat(3*v.length)),h=o.split(`
`,1)[0],g=!p.trim(),m=0;if(this.options.pedantic?(m=2,f=p.trimStart()):g?m=e[1].length+1:(m=e[2].search(this.rules.other.nonSpaceChar),m=m>4?1:m,f=p.slice(m),m+=e[1].length),g&&this.rules.other.blankLine.test(h)&&(d+=h+`
`,o=o.substring(h.length+1),c=!0),!c){const v=this.rules.other.nextBulletRegex(m),T=this.rules.other.hrRegex(m),x=this.rules.other.fencesBeginRegex(m),I=this.rules.other.headingBeginRegex(m),M=this.rules.other.htmlBeginRegex(m);for(;o;){const R=o.split(`
`,1)[0];let k;if(h=R,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),k=h):k=h.replace(this.rules.other.tabCharGlobal,"    "),x.test(h)||I.test(h)||M.test(h)||v.test(h)||T.test(h))break;if(k.search(this.rules.other.nonSpaceChar)>=m||!h.trim())f+=`
`+k.slice(m);else{if(g||p.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||x.test(p)||I.test(p)||T.test(p))break;f+=`
`+h}!g&&!h.trim()&&(g=!0),d+=R+`
`,o=o.substring(R.length+1),p=k.slice(m)}}i.loose||(u?i.loose=!0:this.rules.other.doubleBlankLine.test(d)&&(u=!0));let y=null,C;this.options.gfm&&(y=this.rules.other.listIsTask.exec(f),y&&(C=y[0]!=="[ ] ",f=f.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:d,task:!!y,checked:C,loose:!1,text:f,tokens:[]}),i.raw+=d}const a=i.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let c=0;c<i.items.length;c++)if(this.lexer.state.top=!1,i.items[c].tokens=this.lexer.blockTokens(i.items[c].text,[]),!i.loose){const d=i.items[c].tokens.filter(p=>p.type==="space"),f=d.length>0&&d.some(p=>this.rules.other.anyLine.test(p.raw));i.loose=f}if(i.loose)for(let c=0;c<i.items.length;c++)i.items[c].loose=!0;return i}}html(o){const e=this.rules.block.html.exec(o);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(o){const e=this.rules.block.def.exec(o);if(e){const t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:n,title:i}}}table(o){var u;const e=this.rules.block.table.exec(o);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const t=Jt(e[1]),n=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(u=e[3])!=null&&u.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],r={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===n.length){for(const a of n)this.rules.other.tableAlignRight.test(a)?r.align.push("right"):this.rules.other.tableAlignCenter.test(a)?r.align.push("center"):this.rules.other.tableAlignLeft.test(a)?r.align.push("left"):r.align.push(null);for(let a=0;a<t.length;a++)r.header.push({text:t[a],tokens:this.lexer.inline(t[a]),header:!0,align:r.align[a]});for(const a of i)r.rows.push(Jt(a,r.header.length).map((c,d)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:r.align[d]})));return r}}lheading(o){const e=this.rules.block.lheading.exec(o);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(o){const e=this.rules.block.paragraph.exec(o);if(e){const t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(o){const e=this.rules.block.text.exec(o);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(o){const e=this.rules.inline.escape.exec(o);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(o){const e=this.rules.inline.tag.exec(o);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(o){const e=this.rules.inline.link.exec(o);if(e){const t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;const r=oe(t.slice(0,-1),"\\");if((t.length-r.length)%2===0)return}else{const r=$s(e[2],"()");if(r===-2)return;if(r>-1){const a=(e[0].indexOf("!")===0?5:4)+e[1].length+r;e[2]=e[2].substring(0,r),e[0]=e[0].substring(0,a).trim(),e[3]=""}}let n=e[2],i="";if(this.options.pedantic){const r=this.rules.other.pedanticHrefTitle.exec(n);r&&(n=r[1],i=r[3])}else i=e[3]?e[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?n=n.slice(1):n=n.slice(1,-1)),Xt(e,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(o,e){let t;if((t=this.rules.inline.reflink.exec(o))||(t=this.rules.inline.nolink.exec(o))){const n=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[n.toLowerCase()];if(!i){const r=t[0].charAt(0);return{type:"text",raw:r,text:r}}return Xt(t,i,t[0],this.lexer,this.rules)}}emStrong(o,e,t=""){let n=this.rules.inline.emStrongLDelim.exec(o);if(!n||n[3]&&t.match(this.rules.other.unicodeAlphaNumeric))return;if(!(n[1]||n[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const r=[...n[0]].length-1;let u,a,c=r,d=0;const f=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(f.lastIndex=0,e=e.slice(-1*o.length+r);(n=f.exec(e))!=null;){if(u=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!u)continue;if(a=[...u].length,n[3]||n[4]){c+=a;continue}else if((n[5]||n[6])&&r%3&&!((r+a)%3)){d+=a;continue}if(c-=a,c>0)continue;a=Math.min(a,a+c+d);const p=[...n[0]][0].length,h=o.slice(0,r+n.index+p+a);if(Math.min(r,a)%2){const m=h.slice(1,-1);return{type:"em",raw:h,text:m,tokens:this.lexer.inlineTokens(m)}}const g=h.slice(2,-2);return{type:"strong",raw:h,text:g,tokens:this.lexer.inlineTokens(g)}}}}codespan(o){const e=this.rules.inline.code.exec(o);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," ");const n=this.rules.other.nonSpaceChar.test(t),i=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return n&&i&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(o){const e=this.rules.inline.br.exec(o);if(e)return{type:"br",raw:e[0]}}del(o){const e=this.rules.inline.del.exec(o);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(o){const e=this.rules.inline.autolink.exec(o);if(e){let t,n;return e[2]==="@"?(t=e[1],n="mailto:"+t):(t=e[1],n=t),{type:"link",raw:e[0],text:t,href:n,tokens:[{type:"text",raw:t,text:t}]}}}url(o){var t;let e;if(e=this.rules.inline.url.exec(o)){let n,i;if(e[2]==="@")n=e[0],i="mailto:"+n;else{let r;do r=e[0],e[0]=((t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])??"";while(r!==e[0]);n=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(o){const e=this.rules.inline.text.exec(o);if(e){const t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},V=class De{constructor(e){_(this,"tokens");_(this,"options");_(this,"state");_(this,"tokenizer");_(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||W,this.options.tokenizer=this.options.tokenizer||new we,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:P,block:fe.normal,inline:ne.normal};this.options.pedantic?(t.block=fe.pedantic,t.inline=ne.pedantic):this.options.gfm&&(t.block=fe.gfm,this.options.breaks?t.inline=ne.breaks:t.inline=ne.gfm),this.tokenizer.rules=t}static get rules(){return{block:fe,inline:ne}}static lex(e,t){return new De(t).lex(e)}static lexInline(e,t){return new De(t).inlineTokens(e)}lex(e){e=e.replace(P.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){var i,r,u;for(this.options.pedantic&&(e=e.replace(P.tabCharGlobal,"    ").replace(P.spaceLine,""));e;){let a;if((r=(i=this.options.extensions)==null?void 0:i.block)!=null&&r.some(d=>(a=d.call({lexer:this},e,t))?(e=e.substring(a.raw.length),t.push(a),!0):!1))continue;if(a=this.tokenizer.space(e)){e=e.substring(a.raw.length);const d=t.at(-1);a.raw.length===1&&d!==void 0?d.raw+=`
`:t.push(a);continue}if(a=this.tokenizer.code(e)){e=e.substring(a.raw.length);const d=t.at(-1);(d==null?void 0:d.type)==="paragraph"||(d==null?void 0:d.type)==="text"?(d.raw+=`
`+a.raw,d.text+=`
`+a.text,this.inlineQueue.at(-1).src=d.text):t.push(a);continue}if(a=this.tokenizer.fences(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.heading(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.hr(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.blockquote(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.list(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.html(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.def(e)){e=e.substring(a.raw.length);const d=t.at(-1);(d==null?void 0:d.type)==="paragraph"||(d==null?void 0:d.type)==="text"?(d.raw+=`
`+a.raw,d.text+=`
`+a.raw,this.inlineQueue.at(-1).src=d.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if(a=this.tokenizer.table(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.lheading(e)){e=e.substring(a.raw.length),t.push(a);continue}let c=e;if((u=this.options.extensions)!=null&&u.startBlock){let d=1/0;const f=e.slice(1);let p;this.options.extensions.startBlock.forEach(h=>{p=h.call({lexer:this},f),typeof p=="number"&&p>=0&&(d=Math.min(d,p))}),d<1/0&&d>=0&&(c=e.substring(0,d+1))}if(this.state.top&&(a=this.tokenizer.paragraph(c))){const d=t.at(-1);n&&(d==null?void 0:d.type)==="paragraph"?(d.raw+=`
`+a.raw,d.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):t.push(a),n=c.length!==e.length,e=e.substring(a.raw.length);continue}if(a=this.tokenizer.text(e)){e=e.substring(a.raw.length);const d=t.at(-1);(d==null?void 0:d.type)==="text"?(d.raw+=`
`+a.raw,d.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):t.push(a);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var a,c,d;let n=e,i=null;if(this.tokens.links){const f=Object.keys(this.tokens.links);if(f.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)f.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,i.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let r=!1,u="";for(;e;){r||(u=""),r=!1;let f;if((c=(a=this.options.extensions)==null?void 0:a.inline)!=null&&c.some(h=>(f=h.call({lexer:this},e,t))?(e=e.substring(f.raw.length),t.push(f),!0):!1))continue;if(f=this.tokenizer.escape(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.tag(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.link(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(f.raw.length);const h=t.at(-1);f.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=f.raw,h.text+=f.text):t.push(f);continue}if(f=this.tokenizer.emStrong(e,n,u)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.codespan(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.br(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.del(e)){e=e.substring(f.raw.length),t.push(f);continue}if(f=this.tokenizer.autolink(e)){e=e.substring(f.raw.length),t.push(f);continue}if(!this.state.inLink&&(f=this.tokenizer.url(e))){e=e.substring(f.raw.length),t.push(f);continue}let p=e;if((d=this.options.extensions)!=null&&d.startInline){let h=1/0;const g=e.slice(1);let m;this.options.extensions.startInline.forEach(y=>{m=y.call({lexer:this},g),typeof m=="number"&&m>=0&&(h=Math.min(h,m))}),h<1/0&&h>=0&&(p=e.substring(0,h+1))}if(f=this.tokenizer.inlineText(p)){e=e.substring(f.raw.length),f.raw.slice(-1)!=="_"&&(u=f.raw.slice(-1)),r=!0;const h=t.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=f.raw,h.text+=f.text):t.push(f);continue}if(e){const h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return t}},Se=class{constructor(o){_(this,"options");_(this,"parser");this.options=o||W}space(o){return""}code({text:o,lang:e,escaped:t}){var r;const n=(r=(e||"").match(P.notSpaceStart))==null?void 0:r[0],i=o.replace(P.endingNewline,"")+`
`;return n?'<pre><code class="language-'+q(n)+'">'+(t?i:q(i,!0))+`</code></pre>
`:"<pre><code>"+(t?i:q(i,!0))+`</code></pre>
`}blockquote({tokens:o}){return`<blockquote>
${this.parser.parse(o)}</blockquote>
`}html({text:o}){return o}heading({tokens:o,depth:e}){return`<h${e}>${this.parser.parseInline(o)}</h${e}>
`}hr(o){return`<hr>
`}list(o){const e=o.ordered,t=o.start;let n="";for(let u=0;u<o.items.length;u++){const a=o.items[u];n+=this.listitem(a)}const i=e?"ol":"ul",r=e&&t!==1?' start="'+t+'"':"";return"<"+i+r+`>
`+n+"</"+i+`>
`}listitem(o){var t;let e="";if(o.task){const n=this.checkbox({checked:!!o.checked});o.loose?((t=o.tokens[0])==null?void 0:t.type)==="paragraph"?(o.tokens[0].text=n+" "+o.tokens[0].text,o.tokens[0].tokens&&o.tokens[0].tokens.length>0&&o.tokens[0].tokens[0].type==="text"&&(o.tokens[0].tokens[0].text=n+" "+q(o.tokens[0].tokens[0].text),o.tokens[0].tokens[0].escaped=!0)):o.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):e+=n+" "}return e+=this.parser.parse(o.tokens,!!o.loose),`<li>${e}</li>
`}checkbox({checked:o}){return"<input "+(o?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:o}){return`<p>${this.parser.parseInline(o)}</p>
`}table(o){let e="",t="";for(let i=0;i<o.header.length;i++)t+=this.tablecell(o.header[i]);e+=this.tablerow({text:t});let n="";for(let i=0;i<o.rows.length;i++){const r=o.rows[i];t="";for(let u=0;u<r.length;u++)t+=this.tablecell(r[u]);n+=this.tablerow({text:t})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+n+`</table>
`}tablerow({text:o}){return`<tr>
${o}</tr>
`}tablecell(o){const e=this.parser.parseInline(o.tokens),t=o.header?"th":"td";return(o.align?`<${t} align="${o.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:o}){return`<strong>${this.parser.parseInline(o)}</strong>`}em({tokens:o}){return`<em>${this.parser.parseInline(o)}</em>`}codespan({text:o}){return`<code>${q(o,!0)}</code>`}br(o){return"<br>"}del({tokens:o}){return`<del>${this.parser.parseInline(o)}</del>`}link({href:o,title:e,tokens:t}){const n=this.parser.parseInline(t),i=Wt(o);if(i===null)return n;o=i;let r='<a href="'+o+'"';return e&&(r+=' title="'+q(e)+'"'),r+=">"+n+"</a>",r}image({href:o,title:e,text:t,tokens:n}){n&&(t=this.parser.parseInline(n,this.parser.textRenderer));const i=Wt(o);if(i===null)return q(t);o=i;let r=`<img src="${o}" alt="${t}"`;return e&&(r+=` title="${q(e)}"`),r+=">",r}text(o){return"tokens"in o&&o.tokens?this.parser.parseInline(o.tokens):"escaped"in o&&o.escaped?o.text:q(o.text)}},je=class{strong({text:o}){return o}em({text:o}){return o}codespan({text:o}){return o}del({text:o}){return o}html({text:o}){return o}text({text:o}){return o}link({text:o}){return""+o}image({text:o}){return""+o}br(){return""}},U=class Le{constructor(e){_(this,"options");_(this,"renderer");_(this,"textRenderer");this.options=e||W,this.options.renderer=this.options.renderer||new Se,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new je}static parse(e,t){return new Le(t).parse(e)}static parseInline(e,t){return new Le(t).parseInline(e)}parse(e,t=!0){var i,r;let n="";for(let u=0;u<e.length;u++){const a=e[u];if((r=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&r[a.type]){const d=a,f=this.options.extensions.renderers[d.type].call({parser:this},d);if(f!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(d.type)){n+=f||"";continue}}const c=a;switch(c.type){case"space":{n+=this.renderer.space(c);continue}case"hr":{n+=this.renderer.hr(c);continue}case"heading":{n+=this.renderer.heading(c);continue}case"code":{n+=this.renderer.code(c);continue}case"table":{n+=this.renderer.table(c);continue}case"blockquote":{n+=this.renderer.blockquote(c);continue}case"list":{n+=this.renderer.list(c);continue}case"html":{n+=this.renderer.html(c);continue}case"paragraph":{n+=this.renderer.paragraph(c);continue}case"text":{let d=c,f=this.renderer.text(d);for(;u+1<e.length&&e[u+1].type==="text";)d=e[++u],f+=`
`+this.renderer.text(d);t?n+=this.renderer.paragraph({type:"paragraph",raw:f,text:f,tokens:[{type:"text",raw:f,text:f,escaped:!0}]}):n+=f;continue}default:{const d='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return n}parseInline(e,t=this.renderer){var i,r;let n="";for(let u=0;u<e.length;u++){const a=e[u];if((r=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&r[a.type]){const d=this.options.extensions.renderers[a.type].call({parser:this},a);if(d!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){n+=d||"";continue}}const c=a;switch(c.type){case"escape":{n+=t.text(c);break}case"html":{n+=t.html(c);break}case"link":{n+=t.link(c);break}case"image":{n+=t.image(c);break}case"strong":{n+=t.strong(c);break}case"em":{n+=t.em(c);break}case"codespan":{n+=t.codespan(c);break}case"br":{n+=t.br(c);break}case"del":{n+=t.del(c);break}case"text":{n+=t.text(c);break}default:{const d='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return n}},Me,Ce=(Me=class{constructor(o){_(this,"options");_(this,"block");this.options=o||W}preprocess(o){return o}postprocess(o){return o}processAllTokens(o){return o}provideLexer(){return this.block?V.lex:V.lexInline}provideParser(){return this.block?U.parse:U.parseInline}},_(Me,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),Me),Hs=class{constructor(...o){_(this,"defaults",ze());_(this,"options",this.setOptions);_(this,"parse",this.parseMarkdown(!0));_(this,"parseInline",this.parseMarkdown(!1));_(this,"Parser",U);_(this,"Renderer",Se);_(this,"TextRenderer",je);_(this,"Lexer",V);_(this,"Tokenizer",we);_(this,"Hooks",Ce);this.use(...o)}walkTokens(o,e){var n,i;let t=[];for(const r of o)switch(t=t.concat(e.call(this,r)),r.type){case"table":{const u=r;for(const a of u.header)t=t.concat(this.walkTokens(a.tokens,e));for(const a of u.rows)for(const c of a)t=t.concat(this.walkTokens(c.tokens,e));break}case"list":{const u=r;t=t.concat(this.walkTokens(u.items,e));break}default:{const u=r;(i=(n=this.defaults.extensions)==null?void 0:n.childTokens)!=null&&i[u.type]?this.defaults.extensions.childTokens[u.type].forEach(a=>{const c=u[a].flat(1/0);t=t.concat(this.walkTokens(c,e))}):u.tokens&&(t=t.concat(this.walkTokens(u.tokens,e)))}}return t}use(...o){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return o.forEach(t=>{const n={...t};if(n.async=this.defaults.async||n.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const r=e.renderers[i.name];r?e.renderers[i.name]=function(...u){let a=i.renderer.apply(this,u);return a===!1&&(a=r.apply(this,u)),a}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const r=e[i.level];r?r.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),n.extensions=e),t.renderer){const i=this.defaults.renderer||new Se(this.defaults);for(const r in t.renderer){if(!(r in i))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;const u=r,a=t.renderer[u],c=i[u];i[u]=(...d)=>{let f=a.apply(i,d);return f===!1&&(f=c.apply(i,d)),f||""}}n.renderer=i}if(t.tokenizer){const i=this.defaults.tokenizer||new we(this.defaults);for(const r in t.tokenizer){if(!(r in i))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;const u=r,a=t.tokenizer[u],c=i[u];i[u]=(...d)=>{let f=a.apply(i,d);return f===!1&&(f=c.apply(i,d)),f}}n.tokenizer=i}if(t.hooks){const i=this.defaults.hooks||new Ce;for(const r in t.hooks){if(!(r in i))throw new Error(`hook '${r}' does not exist`);if(["options","block"].includes(r))continue;const u=r,a=t.hooks[u],c=i[u];Ce.passThroughHooks.has(r)?i[u]=d=>{if(this.defaults.async)return Promise.resolve(a.call(i,d)).then(p=>c.call(i,p));const f=a.call(i,d);return c.call(i,f)}:i[u]=(...d)=>{let f=a.apply(i,d);return f===!1&&(f=c.apply(i,d)),f}}n.hooks=i}if(t.walkTokens){const i=this.defaults.walkTokens,r=t.walkTokens;n.walkTokens=function(u){let a=[];return a.push(r.call(this,u)),i&&(a=a.concat(i.call(this,u))),a}}this.defaults={...this.defaults,...n}}),this}setOptions(o){return this.defaults={...this.defaults,...o},this}lexer(o,e){return V.lex(o,e??this.defaults)}parser(o,e){return U.parse(o,e??this.defaults)}parseMarkdown(o){return(t,n)=>{const i={...n},r={...this.defaults,...i},u=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&i.async===!1)return u(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return u(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return u(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));r.hooks&&(r.hooks.options=r,r.hooks.block=o);const a=r.hooks?r.hooks.provideLexer():o?V.lex:V.lexInline,c=r.hooks?r.hooks.provideParser():o?U.parse:U.parseInline;if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(t):t).then(d=>a(d,r)).then(d=>r.hooks?r.hooks.processAllTokens(d):d).then(d=>r.walkTokens?Promise.all(this.walkTokens(d,r.walkTokens)).then(()=>d):d).then(d=>c(d,r)).then(d=>r.hooks?r.hooks.postprocess(d):d).catch(u);try{r.hooks&&(t=r.hooks.preprocess(t));let d=a(t,r);r.hooks&&(d=r.hooks.processAllTokens(d)),r.walkTokens&&this.walkTokens(d,r.walkTokens);let f=c(d,r);return r.hooks&&(f=r.hooks.postprocess(f)),f}catch(d){return u(d)}}}onError(o,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,o){const n="<p>An error occurred:</p><pre>"+q(t.message+"",!0)+"</pre>";return e?Promise.resolve(n):n}if(e)return Promise.reject(t);throw t}}},Y=new Hs;function w(o,e){return Y.parse(o,e)}w.options=w.setOptions=function(o){return Y.setOptions(o),w.defaults=Y.defaults,yn(w.defaults),w};w.getDefaults=ze;w.defaults=W;w.use=function(...o){return Y.use(...o),w.defaults=Y.defaults,yn(w.defaults),w};w.walkTokens=function(o,e){return Y.walkTokens(o,e)};w.parseInline=Y.parseInline;w.Parser=U;w.parser=U.parse;w.Renderer=Se;w.TextRenderer=je;w.Lexer=V;w.lexer=V.lex;w.Tokenizer=we;w.Hooks=Ce;w.parse=w;w.options;w.setOptions;w.use;w.walkTokens;w.parseInline;U.parse;V.lex;/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */const Os=new ls({apiKey:"AIzaSyADxrxKCVBgUwNgZv0at0Vb34f0kbpB7AY"}),zs=document.querySelector(".app-container"),Z=document.querySelector("#input"),Fe=document.querySelector("#generate-btn"),qe=document.querySelector("#output"),L=document.querySelector("#slideshow"),pe=document.querySelector("#error"),Ve=document.querySelector("#actions-container"),Ys=document.querySelector("#download-btn"),X=document.querySelector("#copy-text-btn"),H=document.querySelector("#share-btn"),ie=document.querySelector("#reel-btn"),O=document.querySelector("#reel-share-btn"),Ue=document.querySelector("#theme-selector"),Ge=document.querySelector("#ratio-selector"),$e=document.querySelector("#color-selector");let z="cats",ae="1-1",ee="bw";const Ks="SlideshowDB",Ws=1,G="slideshowStore",_e="currentSlideshow";function et(){return new Promise((o,e)=>{const t=indexedDB.open(Ks,Ws);t.onerror=()=>e(t.error),t.onsuccess=()=>o(t.result),t.onupgradeneeded=()=>{const n=t.result;n.objectStoreNames.contains(G)||n.createObjectStore(G)}})}async function Js(o,e){const n=(await et()).transaction(G,"readwrite");return n.objectStore(G).put(e,o),new Promise((r,u)=>{n.oncomplete=()=>r(),n.onerror=()=>u(n.error)})}async function Xs(o){const i=(await et()).transaction(G,"readonly").objectStore(G).get(o);return new Promise((r,u)=>{i.onsuccess=()=>r(i.result),i.onerror=()=>u(i.error)})}async function Rn(o){const t=(await et()).transaction(G,"readwrite");return t.objectStore(G).delete(o),new Promise((i,r)=>{t.oncomplete=()=>i(),t.onerror=()=>r(t.error)})}async function Zs(o){return(await fetch(o)).blob()}const Qs={cats:"Use a fun story about lots of cats as a metaphor.",robots:"Use a story about happy robots as a metaphor.",trees:"Use a story about wise old trees as a metaphor.",gnomes:"Use a story about busy gnomes as a metaphor.",doodles:"Use a fun story told through simple, hand-drawn doodles as a metaphor.",humans:"Use a simple story about everyday people as a metaphor.",element:"Use a story about the classical elements (earth, water, air, fire) as a metaphor."},Zt={bw:"with black ink on a white background.",muted:"using a muted, vintage color palette.",vibrant:"using a vibrant and playful color palette.",pastel:"using a soft pastel color palette.",duotone:"using a stylish blue and orange duotone color palette."},js=`
Keep sentences short but conversational, casual, and engaging.
Generate a cute, minimal illustration for each sentence `,el=` The main subject should be very large and fill almost the entire image canvas.
No commentary, just begin your explanation.
Keep going until you're done, aiming for around 10-15 slides to fully explain the topic.`;function tl(){const o=Zt[ee]||Zt.bw,e=js+o+el;return Qs[z]+e}function tt(){return ae}async function Qt(o,e){const t=document.createElement("div");t.className="slide",t.classList.add(`ratio-${tt()}`);const n=document.createElement("div");n.className="slide-caption",n.innerHTML=await w.parse(o),t.append(e),t.append(n),L.append(t);const i=()=>{n.classList.add("fade-in")};e.complete?requestAnimationFrame(i):e.onload=i}function nl(o){const t=/{"error":(.*)}/gm.exec(o);try{const n=t[1];return JSON.parse(n).message}catch{return o}}async function kn(o){await Rn(_e),Z.disabled=!0,Fe.disabled=!0,qe.innerHTML="",L.innerHTML="",pe.innerHTML="",pe.toggleAttribute("hidden",!0),Ve.toggleAttribute("hidden",!0);try{const e=document.createElement("div");e.innerHTML=await w.parse(o),e.className="user-turn",qe.append(e),Z.value="";const t=document.createElement("div");t.className="slide question-slide",t.classList.add(`ratio-${tt()}`);const n=document.createElement("div");n.className="slide-caption",n.innerHTML=`You asked:<br><strong>${o}</strong>`,t.append(n),L.append(t),L.removeAttribute("hidden"),requestAnimationFrame(()=>n.classList.add("fade-in"));const i=await Os.models.generateContentStream({model:"gemini-2.5-flash-image-preview",contents:{parts:[{text:o+tl()}]},config:{responseModalities:[ve.TEXT,ve.IMAGE]}});let r="",u=null;for await(const a of i)for(const c of a.candidates)for(const d of c.content.parts??[]){if(d.text)r+=d.text;else try{const f=d.inlineData;f?(u=document.createElement("img"),u.src="data:image/png;base64,"+f.data):console.log("no data",a)}catch{console.log("no data",a)}r&&u&&(await Qt(r,u),r="",u=null)}u&&(await Qt(r,u),r=""),L.children.length>1&&(Ve.removeAttribute("hidden"),await ll(o))}catch(e){const t=nl(String(e));pe.innerHTML=`Something went wrong: ${t}`,pe.removeAttribute("hidden")}Z.disabled=!1,Fe.disabled=!1,Z.focus()}function se(o,e,t,n,i,r){const u=e.split(" ");let a="";for(let c=0;c<u.length;c++){const d=a+u[c]+" ";o.measureText(d).width>i&&c>0?(o.fillText(a,t,n),a=u[c]+" ",n+=r):a=d}o.fillText(a,t,n)}async function ol(){var r,u,a;const o=Array.from(L.querySelectorAll(".slide"));if(o.length===0)return null;const e=document.createElement("canvas"),t=1080,n=1920;e.width=t,e.height=n*o.length;const i=e.getContext("2d");if(!i)return null;try{await document.fonts.load('80px "Indie Flower"'),await document.fonts.load('bold 90px "Indie Flower"');for(let d=0;d<o.length;d++){const f=o[d],p=d*n;if(i.fillStyle="#ffffff",i.fillRect(0,p,t,n),i.fillStyle="#495057",i.textAlign="center",f.classList.contains("question-slide")){const h=(((r=f.querySelector(".slide-caption"))==null?void 0:r.innerText)||"").replace("You asked:","").trim();i.font='80px "Indie Flower"',i.fillText("You Asked:",t/2,p+400),i.font='bold 90px "Indie Flower"',se(i,h,t/2,p+600,t-150,110)}else{const h=f.querySelector("img"),g=((a=(u=f.querySelector(".slide-caption"))==null?void 0:u.textContent)==null?void 0:a.trim())||"";if(h){const m=new Image;m.crossOrigin="anonymous",await new Promise((M,R)=>{m.onload=M,m.onerror=R,m.src=h.src});const y=m.width/m.height,C=980,v=C/y,T=(t-C)/2,x=p+(n-v)/2-200;i.drawImage(m,T,x,C,v),i.font='80px "Indie Flower"';const I=x+v+150;se(i,g,t/2,I,t-100,100)}else i.font='80px "Indie Flower"',se(i,g,t/2,p+n/2,t-100,100)}}const c=await new Promise(d=>e.toBlob(d,"image/png"));return c?new File([c],"reel-story.png",{type:"image/png"}):null}catch(c){return console.error("Failed to generate reel strip file:",c),null}}async function Mn(o,e,t){var c,d,f;const n=document.createElement("canvas");let i=1080,r=1080;switch(t){case"9-16":i=1080,r=1920;break;case"16-9":i=1920,r=1080;break}n.width=i,n.height=r;const u=n.getContext("2d");if(!u)return null;if(await document.fonts.load('60px "Indie Flower"'),await document.fonts.load('bold 70px "Indie Flower"'),u.fillStyle="#ffffff",u.fillRect(0,0,i,r),u.fillStyle="#495057",u.textAlign="center",o.classList.contains("question-slide")){const p=(((c=o.querySelector(".slide-caption"))==null?void 0:c.innerText)||"").replace("You asked:","").trim();u.font='60px "Indie Flower"',u.fillText("You Asked:",i/2,r*.3),u.font='bold 70px "Indie Flower"',se(u,p,i/2,r*.4,i-150,90)}else{const p=o.querySelector("img"),h=((f=(d=o.querySelector(".slide-caption"))==null?void 0:d.textContent)==null?void 0:f.trim())||"";if(p){const g=new Image;g.crossOrigin="anonymous",await new Promise((R,k)=>{g.onload=R,g.onerror=k,g.src=p.src});const m=r*.8,y=i*.9,C=g.width/g.height;let v=m,T=v*C;T>y&&(T=y,v=T/C);const x=(i-T)/2,I=r*.05;u.drawImage(g,x,I,T,v),u.font='60px "Indie Flower"';const M=I+v+40;se(u,h,i/2,M,i-100,80)}}const a=await new Promise(p=>n.toBlob(p,"image/png"));return a?new File([a],`slide-${e+1}.png`,{type:"image/png"}):null}async function il(){const o=H.textContent;H.textContent="PREPARING...",H.disabled=!0;try{const e=Array.from(document.querySelectorAll("#slideshow .slide"));if(e.length===0){alert("No slides to share.");return}const t=tt(),n=(await Promise.all(e.map((i,r)=>Mn(i,r,t)))).filter(i=>i!==null);if(n.length===0){alert("Could not generate images for sharing.");return}navigator.canShare&&navigator.canShare({files:n})?await navigator.share({files:n,title:"My Explanation Slideshow",text:"Check out this explanation I made!"}):alert("Sharing is not supported on your browser.")}catch(e){e.name!=="AbortError"&&(console.error("Error sharing slideshow:",e),alert("Could not share the slideshow."))}finally{H.textContent=o,H.disabled=!1}}async function rl(){ie.textContent="GENERATING...",ie.disabled=!0;try{const o=await ol();if(o){const e=document.createElement("a");e.href=URL.createObjectURL(o),e.download="reel-story.png",document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(e.href)}else alert("Sorry, there was an error creating the images for your Reel.")}catch(o){console.error("Failed to generate reel images:",o),alert("Sorry, there was an error creating the images for your Reel.")}finally{ie.textContent="DOWNLOAD REEL",ie.disabled=!1}}async function sl(){const o=O.textContent;O.textContent="PREPARING...",O.disabled=!0;try{const e=Array.from(document.querySelectorAll("#slideshow .slide"));if(e.length===0){alert("No slides to share for a reel.");return}const t=(await Promise.all(e.map((n,i)=>Mn(n,i,"9-16")))).filter(n=>n!==null);if(t.length===0){alert("Could not generate reel images for sharing.");return}navigator.canShare&&navigator.canShare({files:t})?await navigator.share({files:t,title:"My Explanation Reel",text:"Check out this explanation I made!"}):alert("Sharing is not supported on your browser.")}catch(e){e.name!=="AbortError"&&(console.error("Error sharing reel images:",e),alert("Could not share the reel images."))}finally{O.textContent=o,O.disabled=!1}}async function ll(o){const e=Array.from(document.querySelectorAll("#slideshow .slide"));if(!(e.length<=1))try{const t=await Promise.all(e.map(async i=>{var d,f;const r=i.classList.contains("question-slide"),u=((d=i.querySelector(".slide-caption"))==null?void 0:d.innerHTML)||"",a=((f=i.querySelector("img"))==null?void 0:f.src)||null,c=a?await Zs(a):null;return{isQuestion:r,text:u,imageBlob:c}}));await Js(_e,{question:o,theme:z,ratio:ae,colorStyle:ee,slides:t})}catch(t){console.error("Failed to save slideshow to IndexedDB:",t)}}function j(o,e){o.querySelectorAll("li").forEach(n=>{const i=n.childNodes[0],r=i.textContent||"";n.dataset.value===e?(n.classList.add("selected"),i.textContent=r.replace(/\[\s{3}\]/,"[ * ]")):(n.classList.remove("selected"),i.textContent=r.replace(/\[ \* \]/,"[   ]"))})}function Be(o){zs.className=`app-container theme-${o}`}async function al(){try{const o=await Xs(_e);if(!o){Be(z);return}const{question:e,theme:t,ratio:n,colorStyle:i,slides:r}=o;z=t,ae=n,ee=i||"bw",Be(t),j(Ue,t),j(Ge,n),j($e,ee);const u=document.createElement("div");u.innerHTML=await w.parse(e),u.className="user-turn",qe.append(u),L.innerHTML="";const a=n||"1-1";for(const c of r){const d=document.createElement("div");d.className="slide",d.classList.add(`ratio-${a}`),c.isQuestion&&d.classList.add("question-slide");const f=document.createElement("div");if(f.className="slide-caption",f.innerHTML=c.text,c.imageBlob){const p=document.createElement("img");d.append(p),d.append(f),L.append(d);const h=()=>f.classList.add("fade-in");p.onload=h,p.src=URL.createObjectURL(c.imageBlob),p.complete&&requestAnimationFrame(h)}else d.append(f),L.append(d),requestAnimationFrame(()=>f.classList.add("fade-in"))}L.removeAttribute("hidden"),Ve.removeAttribute("hidden")}catch(o){console.error("Failed to load saved slideshow:",o),await Rn(_e)}}async function ul(){const o=Array.from(L.querySelectorAll(".slide .slide-caption"));if(o.length===0)return;const e=o.map(t=>t.innerText.trim()).join(`

`);try{await navigator.clipboard.writeText(e);const t=X.textContent;X.textContent="COPIED!",X.disabled=!0,setTimeout(()=>{X.textContent=t,X.disabled=!1},2e3)}catch(t){console.error("Failed to copy text: ",t),alert("Could not copy text to clipboard.")}}navigator.share||(H.style.display="none",O.style.display="none");async function Pn(){const o=Z.value.trim();o&&await kn(o)}Z.addEventListener("keydown",async o=>{o.code==="Enter"&&(o.preventDefault(),await Pn())});Fe.addEventListener("click",Pn);const cl=document.querySelectorAll("#examples li");cl.forEach(o=>o.addEventListener("click",async e=>{await kn(o.textContent)}));Ys.addEventListener("click",()=>{L.querySelectorAll("img").forEach((e,t)=>{const n=document.createElement("a");n.href=e.src,n.download=`explanation-slide-${t+1}.png`,document.body.appendChild(n),n.click(),document.body.removeChild(n)})});Ue.addEventListener("click",o=>{const e=o.target;e.tagName==="LI"&&e.dataset.value&&(z=e.dataset.value,j(Ue,z),Be(z))});Ge.addEventListener("click",o=>{const e=o.target;e.tagName==="LI"&&e.dataset.value&&(ae=e.dataset.value,j(Ge,ae))});$e.addEventListener("click",o=>{const e=o.target;e.tagName==="LI"&&e.dataset.value&&(ee=e.dataset.value,j($e,ee))});X.addEventListener("click",ul);H.addEventListener("click",il);ie.addEventListener("click",rl);O.addEventListener("click",sl);al();
